[0m09:56:15.868258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407c0b0>]}


============================== 09:56:15.871127 | 9ab9972b-4ade-4174-a125-6d40ab6280c7 ==============================
[0m09:56:15.871127 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:56:15.871486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:17.174347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:56:17.174748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523f500>]}
[0m09:56:17.257424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2fe00>]}
[0m09:56:17.294557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdbda0>]}
[0m09:56:17.295063 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:56:17.317085 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:56:17.317725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:17.317964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523f560>]}
[0m09:56:18.018414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:56:18.024191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051418b0>]}
[0m09:56:18.074345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df3140>]}
[0m09:56:18.074647 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:56:18.074845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057efc80>]}
[0m09:56:18.075837 [info ] [MainThread]: 
[0m09:56:18.076140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:18.078550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:56:18.116730 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:56:18.116989 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:56:18.117159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:18.263774 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.146 seconds
[0m09:56:18.265566 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:56:18.267263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m09:56:18.267871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:56:18.273780 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:56:18.275431 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:56:18.275768 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:56:18.276064 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:56:18.276328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:18.276600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:18.377691 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m09:56:18.378287 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m09:56:18.378931 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:56:18.379416 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:56:18.379919 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:56:18.380487 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:56:18.404606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:56:18.405271 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m09:56:18.408106 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:56:18.410372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:56:18.421693 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:56:18.422252 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:56:18.431394 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.431951 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.432423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:18.537799 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m09:56:18.538854 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.539622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:18.566751 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m09:56:18.571605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057794c0>]}
[0m09:56:18.572635 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:18.581812 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.582671 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.601926 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:56:18.603558 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.604494 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.605154 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.613824 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:56:18.614992 [debug] [MainThread]: On master: Close
[0m09:56:18.616353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:56:18.617215 [info ] [MainThread]: 
[0m09:56:18.622629 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:56:18.623851 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:56:18.624609 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:56:18.625494 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:56:18.626564 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:56:18.627371 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:56:18.628182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m09:56:18.628892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m09:56:18.629614 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:56:18.630176 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:56:18.630713 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:56:18.631214 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:56:18.640294 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:56:18.643527 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:56:18.646281 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:56:18.647718 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:56:18.648165 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:56:18.648580 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:56:18.686685 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:56:18.687029 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:56:18.689008 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:56:18.689954 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:56:18.690250 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:56:18.690527 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:56:18.690805 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:56:18.691018 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:56:18.691256 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:56:18.691489 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:56:18.691782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:56:18.692000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:18.786450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.095 seconds
[0m09:56:18.786856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m09:56:18.787244 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:56:18.787581 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:56:18.787923 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales;
  );
[0m09:56:18.788290 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers;
  );
[0m09:56:18.798906 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: FROM raw_sales;
                       ^

[0m09:56:18.799277 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: FROM raw_customers;
                           ^

[0m09:56:18.799625 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: ROLLBACK
[0m09:56:18.799946 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: ROLLBACK
[0m09:56:18.803208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m09:56:18.803546 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:56:18.803885 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products;
  );
[0m09:56:18.810410 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:56:18.810870 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:56:18.815719 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM raw_products;
                          ^

[0m09:56:18.816362 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: ROLLBACK
[0m09:56:18.819286 [debug] [Thread-3 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM raw_sales;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:56:18.820662 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM raw_customers;
                             ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:56:18.822055 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447f80>]}
[0m09:56:18.822462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5850>]}
[0m09:56:18.823026 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.19s]
[0m09:56:18.823524 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.19s]
[0m09:56:18.824006 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:56:18.824416 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:56:18.825488 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:56:18.825834 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:56:18.826155 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.orders_by_customer ................................. [[33mSKIP[0m]
[0m09:56:18.826540 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m09:56:18.826858 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.orders_by_day ...................................... [[33mSKIP[0m]
[0m09:56:18.827230 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:56:18.827608 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:56:18.827933 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m09:56:18.828286 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:56:18.828721 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m09:56:18.830958 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM raw_products;
                            ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:56:18.831307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106368920>]}
[0m09:56:18.831788 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.20s]
[0m09:56:18.832239 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:56:18.833129 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.833398 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.833617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:18.934442 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m09:56:18.935015 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.935410 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.935780 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.947744 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:56:18.948131 [debug] [MainThread]: On master: Close
[0m09:56:18.948731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:18.949090 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:56:18.949421 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m09:56:18.949740 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m09:56:18.950197 [info ] [MainThread]: 
[0m09:56:18.950609 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m09:56:18.951802 [debug] [MainThread]: Command end result
[0m09:56:18.981802 [info ] [MainThread]: 
[0m09:56:18.982217 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:56:18.982483 [info ] [MainThread]: 
[0m09:56:18.982815 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM raw_sales;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:56:18.983075 [info ] [MainThread]: 
[0m09:56:18.983365 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM raw_customers;
                             ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:56:18.983607 [info ] [MainThread]: 
[0m09:56:18.983889 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM raw_products;
                            ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:56:18.984133 [info ] [MainThread]: 
[0m09:56:18.984390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
[0m09:56:18.998358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1822715, "process_user_time": 2.035665, "process_kernel_time": 0.209253, "process_mem_max_rss": "140115968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:56:18.998864 [debug] [MainThread]: Command `dbt run` failed at 09:56:18.998792 after 3.18 seconds
[0m09:56:18.999192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104764b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105142000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc890>]}
[0m09:56:18.999500 [debug] [MainThread]: Flushing usage events
[0m09:57:24.329741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb4110>]}


============================== 09:57:24.333104 | c322a947-d386-4167-a618-6ea445755716 ==============================
[0m09:57:24.333104 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:57:24.333462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:24.369099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:57:24.369403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090475f0>]}
[0m09:57:24.431253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0620>]}
[0m09:57:24.467473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c114f0>]}
[0m09:57:24.468006 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:57:24.477430 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:57:24.540520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:57:24.540898 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_sales.sql
[0m09:57:24.541115 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_customers.sql
[0m09:57:24.541329 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_products.sql
[0m09:57:24.681317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:57:24.687723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095be810>]}
[0m09:57:24.736615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109670230>]}
[0m09:57:24.736923 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:57:24.737118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c81af0>]}
[0m09:57:24.738170 [info ] [MainThread]: 
[0m09:57:24.738493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:24.740840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:57:24.768408 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:57:24.768663 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:57:24.768829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:24.916974 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.148 seconds
[0m09:57:24.919016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:57:24.920737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m09:57:24.921291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m09:57:24.927832 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:57:24.929515 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:57:24.929868 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:57:24.930161 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:57:24.930444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:24.930705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:25.052158 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m09:57:25.053030 [debug] [ThreadPool]: SQL status: BEGIN in 0.122 seconds
[0m09:57:25.053801 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:57:25.054299 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:57:25.054820 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:57:25.055361 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:25.071451 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m09:57:25.072101 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:57:25.074562 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:57:25.076622 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:57:25.087943 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:57:25.088811 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:57:25.097065 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.097640 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.098095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:25.225433 [debug] [MainThread]: SQL status: BEGIN in 0.127 seconds
[0m09:57:25.226717 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.227677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:25.246198 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m09:57:25.251025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b6930>]}
[0m09:57:25.252305 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:25.265375 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.266145 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.289479 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:57:25.290909 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.291896 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.292956 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.305269 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m09:57:25.305823 [debug] [MainThread]: On master: Close
[0m09:57:25.306898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:25.307473 [info ] [MainThread]: 
[0m09:57:25.311675 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:57:25.312411 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:57:25.313226 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:57:25.313881 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:57:25.314644 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:57:25.315363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m09:57:25.316060 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:57:25.316676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m09:57:25.317507 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:57:25.318169 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:57:25.318684 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:57:25.329099 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:57:25.329762 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:57:25.334453 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:57:25.337267 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:57:25.337984 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:57:25.344286 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:57:25.363054 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:57:25.380554 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:57:25.380890 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:57:25.382657 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:57:25.383197 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:57:25.383499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:57:25.383734 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:57:25.383951 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:57:25.384172 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:57:25.384385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:25.384586 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:57:25.384780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:25.385067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:25.478618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m09:57:25.479040 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:57:25.479362 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM customers;
  );
[0m09:57:25.487146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m09:57:25.487430 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:57:25.487721 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM products;
  );
[0m09:57:25.491122 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: FROM customers;
                       ^

[0m09:57:25.491415 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: ROLLBACK
[0m09:57:25.499671 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM products;
                      ^

[0m09:57:25.500040 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m09:57:25.500388 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: ROLLBACK
[0m09:57:25.500743 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:57:25.501147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM sales;
  );
[0m09:57:25.502669 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:57:25.506773 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM customers;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:57:25.508027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857b170>]}
[0m09:57:25.508559 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.19s]
[0m09:57:25.509075 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:57:25.511138 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:57:25.512377 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: FROM sales;
                   ^

[0m09:57:25.512693 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: ROLLBACK
[0m09:57:25.513865 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM products;
                        ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:57:25.514190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109619dc0>]}
[0m09:57:25.514643 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.20s]
[0m09:57:25.515079 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:57:25.523885 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:57:25.525865 [debug] [Thread-3 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM sales;
                     ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:57:25.526184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e3d70>]}
[0m09:57:25.526601 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.21s]
[0m09:57:25.527029 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:57:25.527660 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:57:25.527989 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:57:25.528335 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m09:57:25.528652 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.orders_by_customer ................................. [[33mSKIP[0m]
[0m09:57:25.529016 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.orders_by_day ...................................... [[33mSKIP[0m]
[0m09:57:25.529335 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m09:57:25.529702 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:57:25.530048 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:57:25.530381 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m09:57:25.531349 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.531619 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.531857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:25.643923 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m09:57:25.644520 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.644931 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.645315 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.655785 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:57:25.656163 [debug] [MainThread]: On master: Close
[0m09:57:25.656743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:25.657097 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:57:25.657430 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m09:57:25.657747 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m09:57:25.658217 [info ] [MainThread]: 
[0m09:57:25.658634 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:57:25.659830 [debug] [MainThread]: Command end result
[0m09:57:25.687411 [info ] [MainThread]: 
[0m09:57:25.687833 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:57:25.688105 [info ] [MainThread]: 
[0m09:57:25.688447 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM customers;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:57:25.688700 [info ] [MainThread]: 
[0m09:57:25.688985 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM products;
                        ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:57:25.689231 [info ] [MainThread]: 
[0m09:57:25.689510 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM sales;
                     ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:57:25.689751 [info ] [MainThread]: 
[0m09:57:25.690006 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
[0m09:57:25.691282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3996309, "process_user_time": 1.373889, "process_kernel_time": 0.15575, "process_mem_max_rss": "134873088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:57:25.691775 [debug] [MainThread]: Command `dbt run` failed at 09:57:25.691703 after 1.40 seconds
[0m09:57:25.692125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aea270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a93260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fc350>]}
[0m09:57:25.692425 [debug] [MainThread]: Flushing usage events
[0m09:58:30.035221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1c0b0>]}


============================== 09:58:30.038634 | 304f6678-d684-4f6d-9887-a428fb1c79f5 ==============================
[0m09:58:30.038634 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:30.039011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:58:30.085032 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:30.085337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3710>]}
[0m09:58:30.147817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373bd70>]}
[0m09:58:30.184572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5aa50>]}
[0m09:58:30.185609 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:58:30.195860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:58:30.262895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:58:30.263311 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_sales.sql
[0m09:58:30.263537 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_products.sql
[0m09:58:30.263745 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_customers.sql
[0m09:58:30.407090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:58:30.413538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f9460>]}
[0m09:58:30.465292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744cd40>]}
[0m09:58:30.465597 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:58:30.465791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b34a0>]}
[0m09:58:30.466817 [info ] [MainThread]: 
[0m09:58:30.467125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:58:30.469541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:58:30.500658 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:58:30.500922 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:58:30.501091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:30.669920 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.169 seconds
[0m09:58:30.671679 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:58:30.673345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m09:58:30.673892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:58:30.679587 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:58:30.681231 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:58:30.681557 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:58:30.681846 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:58:30.682116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:30.682380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:30.795975 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.796617 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.797266 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:58:30.797775 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:58:30.798299 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:58:30.798895 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:58:30.811393 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m09:58:30.811918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m09:58:30.814035 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:58:30.816097 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:58:30.827783 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:58:30.828258 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:58:30.836951 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.837555 [debug] [MainThread]: On master: BEGIN
[0m09:58:30.838017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:30.952113 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.953123 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.953866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:58:30.968834 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:58:30.971650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bf680>]}
[0m09:58:30.972523 [debug] [MainThread]: On master: ROLLBACK
[0m09:58:30.983916 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.984656 [debug] [MainThread]: On master: BEGIN
[0m09:58:31.008255 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:58:31.009557 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.010320 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.010896 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.019898 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:58:31.020775 [debug] [MainThread]: On master: Close
[0m09:58:31.022293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:31.023167 [info ] [MainThread]: 
[0m09:58:31.029134 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:58:31.029847 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:58:31.030475 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:58:31.031220 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:58:31.032022 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:58:31.033755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m09:58:31.033040 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:58:31.034608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m09:58:31.035531 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:58:31.036232 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:58:31.036877 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:58:31.045835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:58:31.046363 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:58:31.050863 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:58:31.053707 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:58:31.054489 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:58:31.054927 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:58:31.072805 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:58:31.087937 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:58:31.089940 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:58:31.091848 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:58:31.092447 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.092714 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:58:31.092978 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.093190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:31.093410 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.093633 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:58:31.093966 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:58:31.094216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:31.094450 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:58:31.208087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m09:58:31.208570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m09:58:31.209014 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.209422 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.209823 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m09:58:31.210264 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m09:58:31.213150 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m09:58:31.213552 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.213944 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m09:58:31.238748 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m09:58:31.245889 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m09:58:31.246312 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m09:58:31.247651 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.250526 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.253205 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.253686 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:58:31.254047 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m09:58:31.254383 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m09:58:31.264427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.264825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.277439 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:58:31.281442 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m09:58:31.282590 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m09:58:31.283620 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m09:58:31.283938 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.284222 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.284499 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.284774 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m09:58:31.285044 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m09:58:31.285306 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m09:58:31.305559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:58:31.305962 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m09:58:31.311776 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m09:58:31.312124 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m09:58:31.314022 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m09:58:31.319532 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.321229 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m09:58:31.321668 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.321989 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m09:58:31.322397 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.322697 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m09:58:31.323054 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m09:58:31.332582 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:58:31.332870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m09:58:31.334791 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:58:31.335107 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:58:31.336152 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:58:31.337226 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:58:31.338389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feeff0>]}
[0m09:58:31.338973 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:58:31.339369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107882bd0>]}
[0m09:58:31.339697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107883ec0>]}
[0m09:58:31.340093 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:58:31.340507 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.30s]
[0m09:58:31.340910 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:58:31.341401 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:58:31.341761 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:58:31.342224 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:58:31.342574 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m09:58:31.342885 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:58:31.343214 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m09:58:31.343461 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m09:58:31.343772 [info ] [Thread-2 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m09:58:31.344049 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m09:58:31.344344 [info ] [Thread-3 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m09:58:31.344624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m09:58:31.346550 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m09:58:31.346855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.product_performance)
[0m09:58:31.347116 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m09:58:31.347461 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m09:58:31.349295 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m09:58:31.351107 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m09:58:31.351613 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m09:58:31.351920 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m09:58:31.363902 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m09:58:31.366784 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m09:58:31.368515 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m09:58:31.370097 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m09:58:31.370718 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.370961 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.371184 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.371389 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m09:58:31.371596 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m09:58:31.371789 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m09:58:31.371982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:58:31.372173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:58:31.372374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:31.483733 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m09:58:31.484171 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.484521 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m09:58:31.488098 [debug] [Thread-4 (]: SQL status: BEGIN in 0.116 seconds
[0m09:58:31.488413 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.488736 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m09:58:31.493197 [debug] [Thread-2 (]: SQL status: BEGIN in 0.121 seconds
[0m09:58:31.493530 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.493845 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m09:58:31.544820 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.056 seconds
[0m09:58:31.549408 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.550017 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.065 seconds
[0m09:58:31.550562 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.056 seconds
[0m09:58:31.551052 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m09:58:31.554519 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.557850 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.558410 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m09:58:31.558889 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m09:58:31.568074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:58:31.568536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.574848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:58:31.575678 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m09:58:31.577259 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m09:58:31.580322 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m09:58:31.580763 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.581171 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.581528 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.581938 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m09:58:31.582328 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m09:58:31.582667 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m09:58:31.596680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m09:58:31.645295 [debug] [Thread-3 (]: SQL status: COMMIT in 0.062 seconds
[0m09:58:31.645704 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m09:58:31.645966 [debug] [Thread-2 (]: SQL status: COMMIT in 0.063 seconds
[0m09:58:31.647318 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m09:58:31.649090 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.650340 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m09:58:31.650676 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.650922 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m09:58:31.651237 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.651469 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m09:58:31.651774 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m09:58:31.663981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:58:31.664233 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:58:31.665263 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m09:58:31.665507 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:58:31.666342 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m09:58:31.667244 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m09:58:31.667573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742a210>]}
[0m09:58:31.667836 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107429670>]}
[0m09:58:31.668259 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.32s]
[0m09:58:31.668539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742b020>]}
[0m09:58:31.668851 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.32s]
[0m09:58:31.669190 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m09:58:31.669495 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.32s]
[0m09:58:31.669815 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:58:31.670178 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:58:31.670924 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.671123 [debug] [MainThread]: On master: BEGIN
[0m09:58:31.671297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:31.784088 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m09:58:31.784548 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.784833 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.785100 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.795995 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m09:58:31.796324 [debug] [MainThread]: On master: Close
[0m09:58:31.796852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:31.797157 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:58:31.797434 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m09:58:31.797703 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m09:58:31.797963 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m09:58:31.798377 [info ] [MainThread]: 
[0m09:58:31.798733 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m09:58:31.800068 [debug] [MainThread]: Command end result
[0m09:58:31.823222 [info ] [MainThread]: 
[0m09:58:31.823592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:31.823841 [info ] [MainThread]: 
[0m09:58:31.824085 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:58:31.825964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.830401, "process_user_time": 1.55683, "process_kernel_time": 0.195031, "process_mem_max_rss": "136577024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:58:31.826359 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:31.826295 after 1.83 seconds
[0m09:58:31.826634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d25640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071267b0>]}
[0m09:58:31.826899 [debug] [MainThread]: Flushing usage events
[0m09:58:55.552238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1ab70>]}


============================== 09:58:55.555379 | c1ff4414-3dfc-4358-89ff-8ff2b7027a79 ==============================
[0m09:58:55.555379 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:55.555739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:55.601451 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:55.601765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cf4d0>]}
[0m09:58:55.665131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068eb2f0>]}
[0m09:58:55.701492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106272330>]}
[0m09:58:55.702128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:58:55.712372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:58:55.779041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:55.779302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:55.782160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:58:55.802464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106531910>]}
[0m09:58:55.862881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e6840>]}
[0m09:58:55.863190 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:58:55.863389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bf7d0>]}
[0m09:58:55.864286 [info ] [MainThread]: 
[0m09:58:55.864485 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:58:55.865423 [debug] [MainThread]: Command end result
[0m09:58:55.879186 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.367541, "process_user_time": 1.019725, "process_kernel_time": 0.143396, "process_mem_max_rss": "118718464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:58:55.879533 [debug] [MainThread]: Command `dbt test` succeeded at 09:58:55.879486 after 0.37 seconds
[0m09:58:55.879759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106823b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051deea0>]}
[0m09:58:55.879953 [debug] [MainThread]: Flushing usage events
[0m09:59:08.091691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270170>]}


============================== 09:59:08.094220 | 34a76b21-d77d-48ad-b6f2-11f5c340b395 ==============================
[0m09:59:08.094220 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:59:08.094570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:08.130043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:59:08.130348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742fb30>]}
[0m09:59:08.193041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742eb10>]}
[0m09:59:08.229139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f740>]}
[0m09:59:08.229631 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:59:08.238327 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:59:08.300716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:08.300978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:08.303807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:59:08.324191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107366030>]}
[0m09:59:08.374498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d2930>]}
[0m09:59:08.374790 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:59:08.374984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107973e60>]}
[0m09:59:08.375970 [info ] [MainThread]: 
[0m09:59:08.376292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:08.376745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:59:08.408227 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:59:08.408500 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:59:08.408682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.589307 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.180 seconds
[0m09:59:08.590902 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:59:08.591643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now create_d9snqvovhsjpqs_snapshots)
[0m09:59:08.592083 [debug] [ThreadPool]: Creating schema "database: "d9snqvovhsjpqs"
schema: "snapshots"
"
[0m09:59:08.597216 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.597564 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:59:08.597846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:08.706585 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m09:59:08.707452 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.708095 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_d9snqvovhsjpqs_snapshots"} */
create schema if not exists "snapshots"
[0m09:59:08.728028 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.019 seconds
[0m09:59:08.730660 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: COMMIT
[0m09:59:08.731285 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.731786 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: COMMIT
[0m09:59:08.744246 [debug] [ThreadPool]: SQL status: COMMIT in 0.012 seconds
[0m09:59:08.744939 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: Close
[0m09:59:08.754610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_d9snqvovhsjpqs_snapshots, now list_d9snqvovhsjpqs_snapshots)
[0m09:59:08.761716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:59:08.764311 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:59:08.768218 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:59:08.768698 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:59:08.769101 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:59:08.769469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:08.769826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.887811 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m09:59:08.888805 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:59:08.889927 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:59:08.890765 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m09:59:08.891331 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:59:08.891836 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:59:08.910368 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m09:59:08.913939 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:59:08.915011 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:59:08.917116 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:59:08.926425 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:59:08.927317 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:59:08.936658 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:08.937334 [debug] [MainThread]: On master: BEGIN
[0m09:59:08.937815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:09.063828 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m09:59:09.064733 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.065534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:09.085916 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m09:59:09.090706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ccc80>]}
[0m09:59:09.091740 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:09.105148 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.105885 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.132053 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m09:59:09.133370 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.134338 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.135267 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.147731 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:59:09.148359 [debug] [MainThread]: On master: Close
[0m09:59:09.149723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:09.150407 [info ] [MainThread]: 
[0m09:59:09.155605 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.156579 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m09:59:09.157701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m09:59:09.158288 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.169620 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.225367 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.225745 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id,
        order_date as dbt_updated_at,
        order_date as dbt_valid_from,
        nullif(order_date, order_date) as dbt_valid_to
    from (
        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m09:59:09.225991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:09.349993 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.124 seconds
[0m09:59:09.357387 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.357871 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m09:59:09.374594 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m09:59:09.375259 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.376419 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.376850 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m09:59:09.387800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:59:09.388249 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.388707 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      
  
    

  create  table "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id,
        order_date as dbt_updated_at,
        order_date as dbt_valid_from,
        nullif(order_date, order_date) as dbt_valid_to
    from (
        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"

    ) sbq



  );
  
  
[0m09:59:09.419310 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.030 seconds
[0m09:59:09.447043 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m09:59:09.447632 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.448037 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m09:59:09.463503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m09:59:09.465685 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m09:59:09.467871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c77200>]}
[0m09:59:09.468904 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mSELECT 1000[0m in 0.31s]
[0m09:59:09.469643 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.470899 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.471254 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.471565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:09.591494 [debug] [MainThread]: SQL status: BEGIN in 0.120 seconds
[0m09:59:09.592961 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.593577 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.594348 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.607395 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:59:09.608308 [debug] [MainThread]: On master: Close
[0m09:59:09.609601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:09.610174 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m09:59:09.610692 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m09:59:09.611544 [info ] [MainThread]: 
[0m09:59:09.612330 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m09:59:09.613618 [debug] [MainThread]: Command end result
[0m09:59:09.649350 [info ] [MainThread]: 
[0m09:59:09.649876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:09.650206 [info ] [MainThread]: 
[0m09:59:09.650523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:09.652096 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5995879, "process_user_time": 1.329639, "process_kernel_time": 0.157388, "process_mem_max_rss": "130924544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:09.652646 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:59:09.652565 after 1.60 seconds
[0m09:59:09.653026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849af00>]}
[0m09:59:09.653378 [debug] [MainThread]: Flushing usage events
[0m11:53:40.153738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105490b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106117fb0>]}


============================== 11:53:40.156962 | 0cecca54-21bd-4530-b3bc-a148eadc00fb ==============================
[0m11:53:40.156962 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:40.157469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:40.197115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:40.197411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106677a40>]}
[0m11:53:40.274071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106587e00>]}
[0m11:53:40.310831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493ef0>]}
[0m11:53:40.311590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:40.328580 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:40.399429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:40.399708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:40.402650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:40.422776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664bfb0>]}
[0m11:53:40.478722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a728a0>]}
[0m11:53:40.479040 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:40.479231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b99070>]}
[0m11:53:40.480276 [info ] [MainThread]: 
[0m11:53:40.480590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:40.482693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:53:40.515704 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:53:40.515968 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:53:40.516141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.675736 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.159 seconds
[0m11:53:40.677946 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:53:40.679831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m11:53:40.680397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m11:53:40.687262 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:40.689066 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:40.689410 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:53:40.689700 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:53:40.689973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:40.690232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.806151 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m11:53:40.807004 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:53:40.807582 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:40.808195 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:40.808853 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:53:40.809625 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:53:40.826011 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m11:53:40.829232 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:53:40.830045 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m11:53:40.832477 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:53:40.842026 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:53:40.842593 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:53:40.854875 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:40.855370 [debug] [MainThread]: On master: BEGIN
[0m11:53:40.855746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:40.974608 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m11:53:40.975272 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:40.975918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:40.993339 [debug] [MainThread]: SQL status: SELECT 3 in 0.017 seconds
[0m11:53:40.996449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295d30>]}
[0m11:53:40.997185 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:41.006833 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.007340 [debug] [MainThread]: On master: BEGIN
[0m11:53:41.030273 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:53:41.031531 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.032281 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.032910 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.045687 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m11:53:41.046647 [debug] [MainThread]: On master: Close
[0m11:53:41.048291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:41.049156 [info ] [MainThread]: 
[0m11:53:41.054359 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m11:53:41.055273 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m11:53:41.056274 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m11:53:41.057169 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m11:53:41.057981 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m11:53:41.058694 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m11:53:41.059434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m11:53:41.060032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m11:53:41.060692 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m11:53:41.061230 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m11:53:41.061742 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m11:53:41.062233 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m11:53:41.072523 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m11:53:41.075801 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m11:53:41.078585 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m11:53:41.079731 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m11:53:41.080179 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m11:53:41.080603 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m11:53:41.116157 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m11:53:41.118944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m11:53:41.120999 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m11:53:41.121673 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.121962 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.122242 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.122474 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m11:53:41.122716 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m11:53:41.122930 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m11:53:41.123137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:41.123336 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:53:41.123529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:41.227276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m11:53:41.227737 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.228094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.105 seconds
[0m11:53:41.228472 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m11:53:41.228860 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.229260 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m11:53:41.237353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.114 seconds
[0m11:53:41.237751 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.238146 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m11:53:41.253259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m11:53:41.260750 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.261179 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m11:53:41.261552 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:53:41.265618 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.265986 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m11:53:41.266444 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:53:41.269190 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.269626 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:53:41.275821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m11:53:41.278285 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.278650 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:53:41.280244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:53:41.282625 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.283037 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:53:41.283381 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m11:53:41.285822 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.286147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:53:41.287537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m11:53:41.298722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.302715 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:53:41.302997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m11:53:41.304289 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:53:41.304629 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.305787 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:53:41.306162 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.306607 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:53:41.306910 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.307158 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:53:41.307447 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:53:41.321155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.326186 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m11:53:41.326609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m11:53:41.327010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m11:53:41.330884 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.332528 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m11:53:41.334129 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m11:53:41.334441 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m11:53:41.334867 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.335263 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.335688 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m11:53:41.336009 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m11:53:41.345968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m11:53:41.347835 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m11:53:41.348962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7f290>]}
[0m11:53:41.349413 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.349828 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m11:53:41.350835 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m11:53:41.351758 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m11:53:41.352026 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m11:53:41.352957 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m11:53:41.353284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107115220>]}
[0m11:53:41.353614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cff20>]}
[0m11:53:41.353984 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.354404 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.354759 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m11:53:41.355062 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m11:53:41.356199 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m11:53:41.356513 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m11:53:41.356803 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m11:53:41.357105 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m11:53:41.357418 [info ] [Thread-1 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m11:53:41.357848 [info ] [Thread-2 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m11:53:41.358693 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m11:53:41.359042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m11:53:41.359302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m11:53:41.359580 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m11:53:41.359890 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m11:53:41.360130 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m11:53:41.361968 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m11:53:41.363469 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m11:53:41.365207 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m11:53:41.366646 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m11:53:41.366902 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m11:53:41.367117 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m11:53:41.381507 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m11:53:41.383334 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m11:53:41.384810 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m11:53:41.385296 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.385504 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m11:53:41.385712 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.385924 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.386110 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:41.386300 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m11:53:41.386478 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m11:53:41.386737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:41.386919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:41.483317 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m11:53:41.483792 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.484130 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m11:53:41.504656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m11:53:41.505021 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.505364 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m11:53:41.505745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m11:53:41.506154 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.506481 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m11:53:41.516223 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.032 seconds
[0m11:53:41.519174 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.519543 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m11:53:41.531004 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:53:41.533619 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.534018 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m11:53:41.540384 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.034 seconds
[0m11:53:41.543384 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.543774 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.037 seconds
[0m11:53:41.544146 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m11:53:41.544558 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m11:53:41.547220 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.552464 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:53:41.552924 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m11:53:41.553269 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.553645 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:53:41.565037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.567553 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.567923 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m11:53:41.568261 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.568563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m11:53:41.570804 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m11:53:41.573268 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.575869 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.576252 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m11:53:41.576570 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m11:53:41.580791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.582081 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:53:41.582420 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.582731 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:53:41.589796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m11:53:41.591141 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:53:41.591485 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.591795 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:53:41.593294 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m11:53:41.594473 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m11:53:41.595104 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b75f0>]}
[0m11:53:41.595689 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.24s]
[0m11:53:41.596242 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m11:53:41.597401 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.600972 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m11:53:41.601499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.601834 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m11:53:41.602718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m11:53:41.604248 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m11:53:41.604743 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.605034 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m11:53:41.616436 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m11:53:41.617868 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m11:53:41.618439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071351f0>]}
[0m11:53:41.618932 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.26s]
[0m11:53:41.619396 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m11:53:41.623530 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m11:53:41.624601 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m11:53:41.625028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136210>]}
[0m11:53:41.625461 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.27s]
[0m11:53:41.625884 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m11:53:41.626808 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.627071 [debug] [MainThread]: On master: BEGIN
[0m11:53:41.627302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:41.739884 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m11:53:41.740606 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.741097 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.741553 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.751741 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:53:41.752194 [debug] [MainThread]: On master: Close
[0m11:53:41.752909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:41.753339 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m11:53:41.753745 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m11:53:41.754133 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m11:53:41.754513 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m11:53:41.755076 [info ] [MainThread]: 
[0m11:53:41.755588 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m11:53:41.757424 [debug] [MainThread]: Command end result
[0m11:53:41.801447 [info ] [MainThread]: 
[0m11:53:41.802299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:41.802716 [info ] [MainThread]: 
[0m11:53:41.806729 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:53:41.816854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.705324, "process_user_time": 1.443455, "process_kernel_time": 0.213564, "process_mem_max_rss": "127516672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:41.817604 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:41.817492 after 1.71 seconds
[0m11:53:41.818057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573d2e0>]}
[0m11:53:41.818485 [debug] [MainThread]: Flushing usage events
[0m11:53:52.067234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857e90>]}


============================== 11:53:52.070681 | db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07 ==============================
[0m11:53:52.070681 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:52.071032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:53:52.108334 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:52.108642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068860f0>]}
[0m11:53:52.174669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caa690>]}
[0m11:53:52.211688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068feba0>]}
[0m11:53:52.212341 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:52.221128 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:52.288311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:52.288576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:52.291451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:52.311594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb4a0>]}
[0m11:53:52.377919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713f170>]}
[0m11:53:52.378287 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:52.378483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068579b0>]}
[0m11:53:52.379437 [info ] [MainThread]: 
[0m11:53:52.379642 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:53:52.380598 [debug] [MainThread]: Command end result
[0m11:53:52.395081 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.36842787, "process_user_time": 1.003717, "process_kernel_time": 0.097488, "process_mem_max_rss": "119750656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:52.395461 [debug] [MainThread]: Command `dbt test` succeeded at 11:53:52.395410 after 0.37 seconds
[0m11:53:52.395696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106887560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4d730>]}
[0m11:53:52.395886 [debug] [MainThread]: Flushing usage events
[0m11:53:59.450286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105994440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059943b0>]}


============================== 11:53:59.452774 | a537a1ae-3ccf-4d14-9c45-caa981091474 ==============================
[0m11:53:59.452774 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:59.453132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:59.487099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:59.487402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5bdd0>]}
[0m11:53:59.550669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bf9e0>]}
[0m11:53:59.587297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07e30>]}
[0m11:53:59.587793 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:59.596721 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:59.658921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:59.659179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:59.661997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:59.681860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed33b0>]}
[0m11:53:59.733578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fae870>]}
[0m11:53:59.733889 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:59.734103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147e90>]}
[0m11:53:59.735071 [info ] [MainThread]: 
[0m11:53:59.735399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:59.735837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:53:59.767555 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:53:59.767826 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:53:59.768000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:59.921892 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.154 seconds
[0m11:53:59.923963 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:53:59.929230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m11:53:59.929841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m11:53:59.936381 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:59.938016 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:59.938372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:53:59.938674 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:53:59.938953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:59.939222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:00.056544 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:54:00.057247 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:54:00.057888 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m11:54:00.058635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:54:00.059281 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:54:00.059894 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:54:00.072561 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m11:54:00.075185 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:54:00.082609 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.022 seconds
[0m11:54:00.085113 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:54:00.085662 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:54:00.098662 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:54:00.111257 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.111933 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.112356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:00.229310 [debug] [MainThread]: SQL status: BEGIN in 0.117 seconds
[0m11:54:00.230636 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.231754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:00.251498 [debug] [MainThread]: SQL status: SELECT 3 in 0.018 seconds
[0m11:54:00.257326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6b140>]}
[0m11:54:00.258372 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:00.269233 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.270084 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.293302 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:54:00.294614 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.295586 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.296535 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.309300 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m11:54:00.310972 [debug] [MainThread]: On master: Close
[0m11:54:00.313027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:00.314200 [info ] [MainThread]: 
[0m11:54:00.320519 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.321584 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m11:54:00.322369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m11:54:00.322973 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.334569 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.385340 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.385716 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m11:54:00.385963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:00.499016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m11:54:00.499624 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.500166 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.537066 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.036 seconds
[0m11:54:00.577180 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.577762 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

        
  
    

  create temporary table "sales_snapshot__dbt_tmp115400569448"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m11:54:00.604063 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.026 seconds
[0m11:54:00.607032 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.607460 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.621290 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.013 seconds
[0m11:54:00.624828 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.625218 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.640802 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m11:54:00.644076 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.644552 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.656818 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m11:54:00.659911 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.660473 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.672951 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m11:54:00.683501 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.683987 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.696623 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m11:54:00.714620 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.715106 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m11:54:00.727064 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m11:54:00.732621 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.733021 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m11:54:00.742670 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m11:54:00.743164 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.744318 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.744722 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      update "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sales_snapshot__dbt_tmp115400569448" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_valid_to is null;

    insert into "d9snqvovhsjpqs"."snapshots"."sales_snapshot" ("order_id", "customer_id", "product_id", "order_date", "quantity", "total_price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."total_price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sales_snapshot__dbt_tmp115400569448" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:54:00.757732 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.013 seconds
[0m11:54:00.773363 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m11:54:00.773747 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.774035 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m11:54:00.791242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m11:54:00.794709 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m11:54:00.796221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a30b0>]}
[0m11:54:00.797015 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mINSERT 0 0[0m in 0.47s]
[0m11:54:00.797612 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.798736 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.799037 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.799304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:00.915207 [debug] [MainThread]: SQL status: BEGIN in 0.116 seconds
[0m11:54:00.915966 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.916444 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.916885 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.927212 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:54:00.927675 [debug] [MainThread]: On master: Close
[0m11:54:00.928448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:00.928885 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m11:54:00.929285 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m11:54:00.929736 [info ] [MainThread]: 
[0m11:54:00.930251 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m11:54:00.931220 [debug] [MainThread]: Command end result
[0m11:54:00.960684 [info ] [MainThread]: 
[0m11:54:00.961171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:00.961486 [info ] [MainThread]: 
[0m11:54:00.961808 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:54:00.963199 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5510751, "process_user_time": 1.345932, "process_kernel_time": 0.150261, "process_mem_max_rss": "127991808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:00.963746 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:54:00.963670 after 1.55 seconds
[0m11:54:00.964075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059943b0>]}
[0m11:54:00.964389 [debug] [MainThread]: Flushing usage events
[0m13:36:15.847231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB9487C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB91DE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB946F450>]}


============================== 13:36:15.850222 | 5f1c3be8-f1a5-4455-8082-cd370865e115 ==============================
[0m13:36:15.850222 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:36:15.851728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:36:15.918670 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:36:15.919667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f1c3be8-f1a5-4455-8082-cd370865e115', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB94BC310>]}
[0m13:36:16.095842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f1c3be8-f1a5-4455-8082-cd370865e115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB95FBD90>]}
[0m13:36:16.203456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f1c3be8-f1a5-4455-8082-cd370865e115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB66E31D0>]}
[0m13:36:16.205454 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:36:16.219926 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:36:16.386265 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m13:36:16.386265 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\rename.sql
[0m13:36:16.387262 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\refresh.sql
[0m13:36:16.387262 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date.sql
[0m13:36:16.388259 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\relationships.sql
[0m13:36:16.388259 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\create.sql
[0m13:36:16.389258 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\orders_by_customer.sql
[0m13:36:16.389258 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m13:36:16.390254 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\create.sql
[0m13:36:16.390254 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\adapters.sql
[0m13:36:16.390254 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\staging\stg_customers.sql
[0m13:36:16.391759 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m13:36:16.392772 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\any_value.sql
[0m13:36:16.392772 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m13:36:16.393772 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\except.sql
[0m13:36:16.393772 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\safe_cast.sql
[0m13:36:16.394770 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\configs.sql
[0m13:36:16.394770 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m13:36:16.395765 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m13:36:16.395765 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\show.sql
[0m13:36:16.396763 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\rename.sql
[0m13:36:16.396763 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\orders_by_day.sql
[0m13:36:16.397760 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_trunc.sql
[0m13:36:16.397760 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\data_types.sql
[0m13:36:16.398757 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\datediff.sql
[0m13:36:16.398757 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\relation.sql
[0m13:36:16.399755 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\statement.sql
[0m13:36:16.399755 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\last_day.sql
[0m13:36:16.400752 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m13:36:16.400752 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\view.sql
[0m13:36:16.401750 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m13:36:16.402253 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create.sql
[0m13:36:16.403253 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\listagg.sql
[0m13:36:16.403253 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m13:36:16.403253 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\timestamps.sql
[0m13:36:16.404252 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\materialized_view.sql
[0m13:36:16.405250 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\datetime.sql
[0m13:36:16.405250 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\datediff.sql
[0m13:36:16.406283 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\staging\stg_products.sql
[0m13:36:16.406283 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\length.sql
[0m13:36:16.407244 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://snapshots\sales_snapshots.sql
[0m13:36:16.407244 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\catalog.sql
[0m13:36:16.408242 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\incremental.sql
[0m13:36:16.408242 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\unique.sql
[0m13:36:16.409240 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\rename.sql
[0m13:36:16.410237 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m13:36:16.410237 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot.sql
[0m13:36:16.410237 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\hooks.sql
[0m13:36:16.411744 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\freshness.sql
[0m13:36:16.411744 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\replace.sql
[0m13:36:16.412751 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\product_performance.sql
[0m13:36:16.412751 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m13:36:16.413748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\helpers.sql
[0m13:36:16.413748 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\table.sql
[0m13:36:16.414745 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\listagg.sql
[0m13:36:16.414745 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\staging\stg_sales.sql
[0m13:36:16.415742 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_backup.sql
[0m13:36:16.415742 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\replace.sql
[0m13:36:16.416740 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m13:36:16.416740 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\clone.sql
[0m13:36:16.417736 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\schema.sql
[0m13:36:16.418735 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\category_performance.sql
[0m13:36:16.418735 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\drop.sql
[0m13:36:16.419732 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\hash.sql
[0m13:36:16.419732 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m13:36:16.420729 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\position.sql
[0m13:36:16.420729 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\replace.sql
[0m13:36:16.421725 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\unit.sql
[0m13:36:16.421725 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_append.sql
[0m13:36:16.421725 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename_intermediate.sql
[0m13:36:16.423165 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\generate_series.sql
[0m13:36:16.423165 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\alter.sql
[0m13:36:16.424162 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\replace.sql
[0m13:36:16.424162 [debug] [MainThread]: Partial parsing: added file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m13:36:16.425160 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename.sql
[0m13:36:16.425160 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_database.sql
[0m13:36:16.426158 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\replace.sql
[0m13:36:16.426158 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast.sql
[0m13:36:16.427156 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\rename.sql
[0m13:36:16.427156 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\metadata.sql
[0m13:36:16.428153 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\dateadd.sql
[0m13:36:16.428153 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://macros\audit_macro.sql
[0m13:36:16.429150 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\escape_single_quotes.sql
[0m13:36:16.429150 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\merge.sql
[0m13:36:16.430147 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\drop.sql
[0m13:36:16.430654 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\rename.sql
[0m13:36:16.430654 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\sources.yml
[0m13:36:16.431661 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\concat.sql
[0m13:36:16.431661 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\any_value.sql
[0m13:36:16.432670 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations.sql
[0m13:36:16.432670 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast_bool_to_text.sql
[0m13:36:16.433669 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\helpers.sql
[0m13:36:16.433669 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop.sql
[0m13:36:16.434668 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_spine.sql
[0m13:36:16.435667 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_construct.sql
[0m13:36:16.435667 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m13:36:16.436663 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\last_day.sql
[0m13:36:16.436663 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m13:36:16.437661 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\helpers.sql
[0m13:36:16.437661 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\create.sql
[0m13:36:16.438658 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\split_part.sql
[0m13:36:16.438658 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m13:36:16.439655 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\persist_docs.sql
[0m13:36:16.439655 [debug] [MainThread]: Partial parsing: added file: dbt://tests\generic\builtin.sql
[0m13:36:16.440653 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\seed.sql
[0m13:36:16.440653 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\strategies.sql
[0m13:36:16.441650 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_intermediate.sql
[0m13:36:16.442155 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_concat.sql
[0m13:36:16.442155 [debug] [MainThread]: Partial parsing: added file: dbt://macros\python_model\python.sql
[0m13:36:16.443268 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\bool_or.sql
[0m13:36:16.443268 [debug] [MainThread]: Partial parsing: added file: dbt://docs\overview.md
[0m13:36:16.444268 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\drop.sql
[0m13:36:16.444268 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\drop.sql
[0m13:36:16.445265 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\not_null.sql
[0m13:36:16.445265 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\indexes.sql
[0m13:36:16.446262 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\apply_grants.sql
[0m13:36:16.446262 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\columns.sql
[0m13:36:16.447260 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\timestamps.sql
[0m13:36:16.447260 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\validate_sql.sql
[0m13:36:16.448257 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m13:36:16.449255 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\drop.sql
[0m13:36:16.449255 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\strategies.sql
[0m13:36:16.450252 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\literal.sql
[0m13:36:16.450252 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\accepted_values.sql
[0m13:36:16.450252 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\intersect.sql
[0m13:36:16.451759 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop_backup.sql
[0m13:36:16.451759 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\split_part.sql
[0m13:36:16.452771 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m13:36:16.452771 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\replace.sql
[0m13:36:16.453767 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\dateadd.sql
[0m13:36:16.453767 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\test.sql
[0m13:36:16.454765 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\replace.sql
[0m13:36:16.454765 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\right.sql
[0m13:36:16.455762 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m13:36:16.455762 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\schema.sql
[0m13:36:16.456759 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\where_subquery.sql
[0m13:36:16.456759 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations.sql
[0m13:36:16.457757 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/dateadd.sql
[0m13:36:16.457757 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/show.sql
[0m13:36:16.458754 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/position.sql
[0m13:36:16.458754 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast.sql
[0m13:36:16.459752 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_append.sql
[0m13:36:16.459752 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename_intermediate.sql
[0m13:36:16.460749 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/unit.sql
[0m13:36:16.460749 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/replace.sql
[0m13:36:16.461747 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/concat.sql
[0m13:36:16.462254 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/marts/sales_reporting/orders_by_customer.sql
[0m13:36:16.462254 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/python_model/python.sql
[0m13:36:16.463256 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/length.sql
[0m13:36:16.463256 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/last_day.sql
[0m13:36:16.464257 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_trunc.sql
[0m13:36:16.464257 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/last_day.sql
[0m13:36:16.464257 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests/generic/builtin.sql
[0m13:36:16.465254 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop.sql
[0m13:36:16.465254 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/listagg.sql
[0m13:36:16.466251 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/merge.sql
[0m13:36:16.466251 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/refresh.sql
[0m13:36:16.467249 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/dateadd.sql
[0m13:36:16.467249 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://macros/audit_macro.sql
[0m13:36:16.468244 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/marts/sales_reporting/product_performance.sql
[0m13:36:16.468244 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/any_value.sql
[0m13:36:16.469243 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/table.sql
[0m13:36:16.469243 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/replace.sql
[0m13:36:16.470241 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/strategies.sql
[0m13:36:16.470241 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/literal.sql
[0m13:36:16.470241 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/not_null.sql
[0m13:36:16.471746 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/statement.sql
[0m13:36:16.472790 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/clone.sql
[0m13:36:16.472790 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop_backup.sql
[0m13:36:16.473786 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/relation.sql
[0m13:36:16.473786 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/unique.sql
[0m13:36:16.473786 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/staging/stg_sales.sql
[0m13:36:16.474783 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/where_subquery.sql
[0m13:36:16.474783 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/split_part.sql
[0m13:36:16.475780 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/datediff.sql
[0m13:36:16.475780 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/listagg.sql
[0m13:36:16.476778 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/test.sql
[0m13:36:16.476778 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create.sql
[0m13:36:16.477775 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/freshness.sql
[0m13:36:16.477775 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m13:36:16.478773 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs/overview.md
[0m13:36:16.478773 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/helpers.sql
[0m13:36:16.479770 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/hooks.sql
[0m13:36:16.479770 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/configs.sql
[0m13:36:16.480767 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/create.sql
[0m13:36:16.480767 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot.sql
[0m13:36:16.481764 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/columns.sql
[0m13:36:16.482271 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/helpers.sql
[0m13:36:16.482271 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/drop.sql
[0m13:36:16.483273 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/timestamps.sql
[0m13:36:16.483273 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/rename.sql
[0m13:36:16.484274 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m13:36:16.484274 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m13:36:16.485270 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/rename.sql
[0m13:36:16.485270 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/safe_cast.sql
[0m13:36:16.486268 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m13:36:16.486268 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/replace.sql
[0m13:36:16.487284 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/catalog.sql
[0m13:36:16.488263 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m13:36:16.488263 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/staging/stg_products.sql
[0m13:36:16.489260 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/rename.sql
[0m13:36:16.489260 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/view.sql
[0m13:36:16.490258 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/create.sql
[0m13:36:16.490258 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_construct.sql
[0m13:36:16.490258 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/accepted_values.sql
[0m13:36:16.490258 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m13:36:16.491765 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m13:36:16.491765 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://snapshots/sales_snapshots.sql
[0m13:36:16.492776 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_spine.sql
[0m13:36:16.492776 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/drop.sql
[0m13:36:16.493773 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/adapters.sql
[0m13:36:16.494770 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/staging/stg_customers.sql
[0m13:36:16.494770 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/data_types.sql
[0m13:36:16.495767 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m13:36:16.495767 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast_bool_to_text.sql
[0m13:36:16.496765 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/apply_grants.sql
[0m13:36:16.496765 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/persist_docs.sql
[0m13:36:16.497762 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/hash.sql
[0m13:36:16.497762 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m13:36:16.498759 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/strategies.sql
[0m13:36:16.498759 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m13:36:16.499756 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/escape_single_quotes.sql
[0m13:36:16.499756 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/relationships.sql
[0m13:36:16.499756 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/datetime.sql
[0m13:36:16.500754 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/replace.sql
[0m13:36:16.501751 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_backup.sql
[0m13:36:16.501751 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/right.sql
[0m13:36:16.502859 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m13:36:16.502859 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_concat.sql
[0m13:36:16.503856 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/replace.sql
[0m13:36:16.503856 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/marts/sales_reporting/orders_by_day.sql
[0m13:36:16.504853 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m13:36:16.504853 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/indexes.sql
[0m13:36:16.505850 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/schema.sql
[0m13:36:16.505850 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_intermediate.sql
[0m13:36:16.506847 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date.sql
[0m13:36:16.506847 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/generate_series.sql
[0m13:36:16.507845 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m13:36:16.507845 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/rename.sql
[0m13:36:16.508842 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/materialized_view.sql
[0m13:36:16.508842 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/helpers.sql
[0m13:36:16.509841 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/any_value.sql
[0m13:36:16.509841 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m13:36:16.509841 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m13:36:16.511349 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_database.sql
[0m13:36:16.511349 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/timestamps.sql
[0m13:36:16.512362 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/replace.sql
[0m13:36:16.512362 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/drop.sql
[0m13:36:16.513429 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/intersect.sql
[0m13:36:16.513429 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/replace.sql
[0m13:36:16.514429 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename.sql
[0m13:36:16.514429 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/incremental.sql
[0m13:36:16.514429 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/alter.sql
[0m13:36:16.515426 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/drop.sql
[0m13:36:16.515426 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/create.sql
[0m13:36:16.516423 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/metadata.sql
[0m13:36:16.516423 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m13:36:16.517420 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/validate_sql.sql
[0m13:36:16.517420 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m13:36:16.518417 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m13:36:16.519416 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/except.sql
[0m13:36:16.519416 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/seed.sql
[0m13:36:16.519416 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/drop.sql
[0m13:36:16.520412 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/datediff.sql
[0m13:36:16.520412 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/split_part.sql
[0m13:36:16.521410 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/rename.sql
[0m13:36:16.521410 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/schema.sql
[0m13:36:16.522434 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/bool_or.sql
[0m13:36:16.522434 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m13:36:16.523559 [error] [MainThread]: Encountered an error:
'ecommerce_project://macros\\audit_macro.sql'
[0m13:36:16.525555 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 399, in load
    self.load_and_parse_macros(project_parser_files)
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 676, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'ecommerce_project://macros\\audit_macro.sql'

[0m13:36:16.527552 [debug] [MainThread]: Command `dbt run` failed at 13:36:16.526553 after 0.76 seconds
[0m13:36:16.527552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB270E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB270F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB9731AD0>]}
[0m13:36:16.528550 [debug] [MainThread]: Flushing usage events
[0m11:49:09.622962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C83CB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C840D590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C841E4D0>]}


============================== 11:49:09.714104 | 7eaec43f-de87-4620-8393-7a7b7351cf8f ==============================
[0m11:49:09.714104 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:49:09.717100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:09.792350 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:49:09.793349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7eaec43f-de87-4620-8393-7a7b7351cf8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C845FC90>]}
[0m11:49:10.059185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eaec43f-de87-4620-8393-7a7b7351cf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C851FF90>]}
[0m11:49:10.122143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eaec43f-de87-4620-8393-7a7b7351cf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C5683650>]}
[0m11:49:10.124140 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:49:10.133623 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:49:10.491177 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m11:49:10.492174 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename_intermediate.sql
[0m11:49:10.492174 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\metadata.sql
[0m11:49:10.493171 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\last_day.sql
[0m11:49:10.493171 [debug] [MainThread]: Partial parsing: added file: dbt://docs\overview.md
[0m11:49:10.494169 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m11:49:10.494169 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\datediff.sql
[0m11:49:10.495166 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\freshness.sql
[0m11:49:10.495166 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\any_value.sql
[0m11:49:10.496163 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\replace.sql
[0m11:49:10.496163 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m11:49:10.497161 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\unit.sql
[0m11:49:10.497161 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\drop.sql
[0m11:49:10.498158 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\merge.sql
[0m11:49:10.498158 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\split_part.sql
[0m11:49:10.499155 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\show.sql
[0m11:49:10.499155 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m11:49:10.500153 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\configs.sql
[0m11:49:10.500153 [debug] [MainThread]: Partial parsing: added file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m11:49:10.501178 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\orders_by_customer.sql
[0m11:49:10.501178 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_trunc.sql
[0m11:49:10.502174 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\length.sql
[0m11:49:10.502174 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\rename.sql
[0m11:49:10.503171 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m11:49:10.503171 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_database.sql
[0m11:49:10.504169 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\persist_docs.sql
[0m11:49:10.504169 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m11:49:10.505166 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_concat.sql
[0m11:49:10.505166 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\except.sql
[0m11:49:10.506164 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\helpers.sql
[0m11:49:10.506164 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\concat.sql
[0m11:49:10.507161 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\staging\stg_customers.sql
[0m11:49:10.507161 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\strategies.sql
[0m11:49:10.508158 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\hash.sql
[0m11:49:10.508158 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\drop.sql
[0m11:49:10.509155 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\validate_sql.sql
[0m11:49:10.509155 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop.sql
[0m11:49:10.510153 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\hooks.sql
[0m11:49:10.510153 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\safe_cast.sql
[0m11:49:10.510153 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\drop_backup.sql
[0m11:49:10.511440 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\columns.sql
[0m11:49:10.511440 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\catalog.sql
[0m11:49:10.512437 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\any_value.sql
[0m11:49:10.512437 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\bool_or.sql
[0m11:49:10.513434 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot.sql
[0m11:49:10.513434 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\rename.sql
[0m11:49:10.514431 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_construct.sql
[0m11:49:10.514431 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\replace.sql
[0m11:49:10.515429 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\replace.sql
[0m11:49:10.515429 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\rename.sql
[0m11:49:10.516426 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\helpers.sql
[0m11:49:10.516426 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\literal.sql
[0m11:49:10.517423 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\array_append.sql
[0m11:49:10.517423 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create.sql
[0m11:49:10.517423 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m11:49:10.518421 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\datetime.sql
[0m11:49:10.518421 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\sources.yml
[0m11:49:10.518421 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\replace.sql
[0m11:49:10.519927 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\clone.sql
[0m11:49:10.519927 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\seeds\seed.sql
[0m11:49:10.520934 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m11:49:10.520934 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\view.sql
[0m11:49:10.522279 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\materialized_view.sql
[0m11:49:10.522279 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\indexes.sql
[0m11:49:10.523276 [debug] [MainThread]: Partial parsing: added file: dbt://macros\etc\statement.sql
[0m11:49:10.523276 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations.sql
[0m11:49:10.524273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\alter.sql
[0m11:49:10.524273 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m11:49:10.525270 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\dateadd.sql
[0m11:49:10.526268 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\staging\stg_sales.sql
[0m11:49:10.526268 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast_bool_to_text.sql
[0m11:49:10.527265 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\create.sql
[0m11:49:10.527265 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\escape_single_quotes.sql
[0m11:49:10.528262 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\timestamps.sql
[0m11:49:10.528262 [debug] [MainThread]: Partial parsing: added file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m11:49:10.529259 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\rename.sql
[0m11:49:10.529259 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\cast.sql
[0m11:49:10.530257 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\last_day.sql
[0m11:49:10.530257 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\view\replace.sql
[0m11:49:10.530257 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\listagg.sql
[0m11:49:10.531626 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\schema.sql
[0m11:49:10.531626 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\right.sql
[0m11:49:10.532623 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\position.sql
[0m11:49:10.532623 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\replace.sql
[0m11:49:10.533620 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\test.sql
[0m11:49:10.533620 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\split_part.sql
[0m11:49:10.534617 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_backup.sql
[0m11:49:10.534617 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://macros\audit_macro.sql
[0m11:49:10.535615 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\not_null.sql
[0m11:49:10.535615 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\drop.sql
[0m11:49:10.536612 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\create.sql
[0m11:49:10.536612 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\orders_by_day.sql
[0m11:49:10.537609 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m11:49:10.537609 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\unique.sql
[0m11:49:10.538606 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m11:49:10.538606 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\schema.sql
[0m11:49:10.540112 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\generate_series.sql
[0m11:49:10.540112 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\refresh.sql
[0m11:49:10.541119 [debug] [MainThread]: Partial parsing: added file: dbt://macros\python_model\python.sql
[0m11:49:10.541119 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\table.sql
[0m11:49:10.542458 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\accepted_values.sql
[0m11:49:10.542458 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\relation.sql
[0m11:49:10.543457 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\replace.sql
[0m11:49:10.543457 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\table\rename.sql
[0m11:49:10.544455 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\category_performance.sql
[0m11:49:10.544455 [debug] [MainThread]: Partial parsing: added file: dbt://macros\adapters\apply_grants.sql
[0m11:49:10.545452 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\data_types.sql
[0m11:49:10.545452 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m11:49:10.546449 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\helpers.sql
[0m11:49:10.546449 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m11:49:10.547447 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m11:49:10.547447 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\timestamps.sql
[0m11:49:10.548444 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date.sql
[0m11:49:10.548444 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\staging\stg_products.sql
[0m11:49:10.548444 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\product_performance.sql
[0m11:49:10.549950 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\tests\where_subquery.sql
[0m11:49:10.549950 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\rename.sql
[0m11:49:10.550957 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\materialized_view\drop.sql
[0m11:49:10.550957 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\intersect.sql
[0m11:49:10.551955 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\adapters.sql
[0m11:49:10.551955 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m11:49:10.552955 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\create_intermediate.sql
[0m11:49:10.552955 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\date_spine.sql
[0m11:49:10.553952 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://snapshots\sales_snapshots.sql
[0m11:49:10.553952 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\incremental.sql
[0m11:49:10.554949 [debug] [MainThread]: Partial parsing: added file: dbt://macros\utils\datediff.sql
[0m11:49:10.554949 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\table\drop.sql
[0m11:49:10.555947 [debug] [MainThread]: Partial parsing: added file: dbt://macros\relations\view\create.sql
[0m11:49:10.556944 [debug] [MainThread]: Partial parsing: added file: dbt://tests\generic\builtin.sql
[0m11:49:10.556944 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m11:49:10.557941 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m11:49:10.557941 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\dateadd.sql
[0m11:49:10.558938 [debug] [MainThread]: Partial parsing: added file: dbt://macros\materializations\models\incremental\strategies.sql
[0m11:49:10.558938 [debug] [MainThread]: Partial parsing: added file: dbt://macros\generic_test_sql\relationships.sql
[0m11:49:10.559988 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\listagg.sql
[0m11:49:10.559988 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m11:49:10.560991 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m11:49:10.560991 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_intermediate.sql
[0m11:49:10.560991 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_concat.sql
[0m11:49:10.562154 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/drop.sql
[0m11:49:10.562154 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/hash.sql
[0m11:49:10.563151 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/persist_docs.sql
[0m11:49:10.563151 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/replace.sql
[0m11:49:10.564148 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/rename.sql
[0m11:49:10.564148 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/schema.sql
[0m11:49:10.565146 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename_intermediate.sql
[0m11:49:10.565146 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/split_part.sql
[0m11:49:10.566143 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/replace.sql
[0m11:49:10.566143 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/bool_or.sql
[0m11:49:10.566143 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m11:49:10.567140 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/rename.sql
[0m11:49:10.567140 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/drop.sql
[0m11:49:10.568138 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/listagg.sql
[0m11:49:10.568138 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/any_value.sql
[0m11:49:10.569135 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/dateadd.sql
[0m11:49:10.569135 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m11:49:10.570132 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/unique.sql
[0m11:49:10.570132 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/relation.sql
[0m11:49:10.570132 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/materialized_view.sql
[0m11:49:10.571560 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m11:49:10.571560 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m11:49:10.572557 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/datediff.sql
[0m11:49:10.572557 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/concat.sql
[0m11:49:10.572557 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/validate_sql.sql
[0m11:49:10.573554 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create.sql
[0m11:49:10.573554 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/drop.sql
[0m11:49:10.574551 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/show.sql
[0m11:49:10.574551 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/statement.sql
[0m11:49:10.575549 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/length.sql
[0m11:49:10.575549 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/replace.sql
[0m11:49:10.576546 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/helpers.sql
[0m11:49:10.576546 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/catalog.sql
[0m11:49:10.577543 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/marts/sales_reporting/orders_by_day.sql
[0m11:49:10.577543 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/configs.sql
[0m11:49:10.578541 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/view/drop.sql
[0m11:49:10.578541 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m11:49:10.578541 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/staging/stg_products.sql
[0m11:49:10.580046 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m11:49:10.580046 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_trunc.sql
[0m11:49:10.581052 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/any_value.sql
[0m11:49:10.581052 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations.sql
[0m11:49:10.581052 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/staging/stg_sales.sql
[0m11:49:10.582174 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m11:49:10.582174 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot.sql
[0m11:49:10.583172 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/create.sql
[0m11:49:10.583172 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/accepted_values.sql
[0m11:49:10.584169 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/rename.sql
[0m11:49:10.584169 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/marts/sales_reporting/product_performance.sql
[0m11:49:10.585166 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m11:49:10.585166 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/strategies.sql
[0m11:49:10.586163 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/where_subquery.sql
[0m11:49:10.586163 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop.sql
[0m11:49:10.587161 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/test.sql
[0m11:49:10.587161 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/except.sql
[0m11:49:10.587161 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date_spine.sql
[0m11:49:10.588158 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/replace.sql
[0m11:49:10.588158 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m11:49:10.589155 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/right.sql
[0m11:49:10.589155 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/timestamps.sql
[0m11:49:10.590153 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m11:49:10.590153 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/strategies.sql
[0m11:49:10.591246 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/alter.sql
[0m11:49:10.591246 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/split_part.sql
[0m11:49:10.592243 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/rename.sql
[0m11:49:10.592243 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/dateadd.sql
[0m11:49:10.592243 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/tests/unit.sql
[0m11:49:10.593240 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/etc/datetime.sql
[0m11:49:10.593240 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/staging/stg_customers.sql
[0m11:49:10.594237 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/adapters.sql
[0m11:49:10.594237 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs/overview.md
[0m11:49:10.595235 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_append.sql
[0m11:49:10.595235 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/array_construct.sql
[0m11:49:10.596232 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/relationships.sql
[0m11:49:10.596232 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/intersect.sql
[0m11:49:10.597229 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/replace.sql
[0m11:49:10.597229 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/schema.sql
[0m11:49:10.598236 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/hooks.sql
[0m11:49:10.598236 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m11:49:10.599224 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/materialized_view/refresh.sql
[0m11:49:10.599224 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/seed.sql
[0m11:49:10.600221 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/last_day.sql
[0m11:49:10.600725 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/create.sql
[0m11:49:10.600725 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/columns.sql
[0m11:49:10.601731 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests/generic/builtin.sql
[0m11:49:10.601731 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/create_backup.sql
[0m11:49:10.602731 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_database.sql
[0m11:49:10.602731 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/clone.sql
[0m11:49:10.603728 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m11:49:10.603728 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/rename.sql
[0m11:49:10.604725 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/datediff.sql
[0m11:49:10.604725 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/merge.sql
[0m11:49:10.605723 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://macros/audit_macro.sql
[0m11:49:10.605723 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/freshness.sql
[0m11:49:10.605723 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/safe_cast.sql
[0m11:49:10.606720 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/create.sql
[0m11:49:10.607717 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/metadata.sql
[0m11:49:10.607717 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/escape_single_quotes.sql
[0m11:49:10.607717 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/snapshots/helpers.sql
[0m11:49:10.608715 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/rename.sql
[0m11:49:10.608715 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/position.sql
[0m11:49:10.608715 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/generic_test_sql/not_null.sql
[0m11:49:10.610221 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/view/replace.sql
[0m11:49:10.610221 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m11:49:10.611225 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m11:49:10.611225 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast.sql
[0m11:49:10.612222 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://snapshots/sales_snapshots.sql
[0m11:49:10.612222 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/table.sql
[0m11:49:10.613219 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/last_day.sql
[0m11:49:10.613219 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/apply_grants.sql
[0m11:49:10.614227 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/table/drop.sql
[0m11:49:10.614227 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/incremental/incremental.sql
[0m11:49:10.615214 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/seeds/helpers.sql
[0m11:49:10.615214 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/indexes.sql
[0m11:49:10.615214 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/literal.sql
[0m11:49:10.616211 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/date.sql
[0m11:49:10.616211 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_project://models/marts/sales_reporting/orders_by_customer.sql
[0m11:49:10.617209 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/adapters/timestamps.sql
[0m11:49:10.617209 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/view.sql
[0m11:49:10.618206 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m11:49:10.618206 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/generate_series.sql
[0m11:49:10.619203 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/cast_bool_to_text.sql
[0m11:49:10.619203 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/utils/data_types.sql
[0m11:49:10.620201 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/listagg.sql
[0m11:49:10.620201 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m11:49:10.621247 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/python_model/python.sql
[0m11:49:10.621247 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m11:49:10.622243 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/relations/table/replace.sql
[0m11:49:10.622243 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m11:49:10.623241 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros/relations/drop_backup.sql
[0m11:49:10.623241 [error] [MainThread]: Encountered an error:
'ecommerce_project://macros\\audit_macro.sql'
[0m11:49:10.626091 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 399, in load
    self.load_and_parse_macros(project_parser_files)
  File "C:\Users\qwc12\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 676, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'ecommerce_project://macros\\audit_macro.sql'

[0m11:49:10.628089 [debug] [MainThread]: Command `dbt run` failed at 11:49:10.628089 after 1.10 seconds
[0m11:49:10.629086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C168F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C168F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C8290650>]}
[0m11:49:10.629086 [debug] [MainThread]: Flushing usage events
[0m11:50:15.576406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E73A1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E73BB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E73A0AD0>]}


============================== 11:50:15.580544 | d73126f2-5d56-4f0c-9235-10e1e632a2a1 ==============================
[0m11:50:15.580544 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:50:15.581825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:15.586814 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:50:15.587812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd73126f2-5d56-4f0c-9235-10e1e632a2a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E739F690>]}
[0m11:50:15.755152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd73126f2-5d56-4f0c-9235-10e1e632a2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E7400A50>]}
[0m11:50:15.790199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m11:50:15.791231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd73126f2-5d56-4f0c-9235-10e1e632a2a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E74FCF50>]}
[0m11:50:15.909125 [debug] [MainThread]: Command `dbt clean` succeeded at 11:50:15.909125 after 0.41 seconds
[0m11:50:15.910129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E734A050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E739F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E08FC150>]}
[0m11:50:15.910129 [debug] [MainThread]: Flushing usage events
[0m11:50:18.333880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271FD32250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227200D6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227200BF090>]}


============================== 11:50:18.337869 | fbb7bd8a-03df-405f-85e9-590bdbf731fb ==============================
[0m11:50:18.337869 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:50:18.338867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:18.344333 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:50:18.345331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fbb7bd8a-03df-405f-85e9-590bdbf731fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227200BFF10>]}
[0m11:50:18.509954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb7bd8a-03df-405f-85e9-590bdbf731fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022720172C50>]}
[0m11:50:18.542263 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:50:18.544258 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:50:18.545254 [debug] [MainThread]: Command `dbt deps` succeeded at 11:50:18.545254 after 0.29 seconds
[0m11:50:18.546251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022720069F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227195CC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271932F390>]}
[0m11:50:18.546251 [debug] [MainThread]: Flushing usage events
[0m11:50:20.873029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A125B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A12A4990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A101E350>]}


============================== 11:50:20.877017 | 2b722b11-3239-4549-92f3-82eb87f862ac ==============================
[0m11:50:20.877017 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:50:20.877017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:20.942350 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:50:20.943379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A12C79D0>]}
[0m11:50:21.108267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A1379CD0>]}
[0m11:50:21.170920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199E5235D0>]}
[0m11:50:21.172710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:50:21.181290 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:50:21.182884 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:50:21.183827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A12A4450>]}
[0m11:50:22.452933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:50:22.463417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A156A7D0>]}
[0m11:50:22.579297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A299B150>]}
[0m11:50:22.579297 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m11:50:22.580317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A26E27D0>]}
[0m11:50:22.582315 [info ] [MainThread]: 
[0m11:50:22.583313 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:50:22.587397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m11:50:22.588397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m11:50:24.659336 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:50:24.659336 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:50:24.659336 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:50:24.660334 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:50:24.660334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:24.661551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:25.046244 [debug] [ThreadPool]: SQL status: BEGIN in 0.385 seconds
[0m11:50:25.049254 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:50:25.050768 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:50:25.070722 [debug] [ThreadPool]: SQL status: BEGIN in 0.410 seconds
[0m11:50:25.071721 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:50:25.071721 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:50:25.088759 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.037 seconds
[0m11:50:25.091400 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:50:25.125068 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m11:50:25.125068 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:50:25.128056 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:50:25.173335 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:50:25.185404 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:25.187403 [debug] [MainThread]: On master: BEGIN
[0m11:50:25.188399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:25.663504 [debug] [MainThread]: SQL status: BEGIN in 0.475 seconds
[0m11:50:25.664509 [debug] [MainThread]: Using postgres connection "master"
[0m11:50:25.664509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:50:25.720144 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m11:50:25.722177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b722b11-3239-4549-92f3-82eb87f862ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199FD7EA90>]}
[0m11:50:25.722177 [debug] [MainThread]: On master: ROLLBACK
[0m11:50:25.755587 [debug] [MainThread]: On master: Close
[0m11:50:25.758592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:50:25.761141 [info ] [MainThread]: 
[0m11:50:25.778442 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m11:50:25.779428 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m11:50:25.780421 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m11:50:25.782862 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_customers'
[0m11:50:25.783856 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m11:50:25.786416 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m11:50:25.787410 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m11:50:25.789405 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m11:50:25.790403 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m11:50:25.801468 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m11:50:25.804458 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m11:50:25.807451 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m11:50:25.811716 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m11:50:25.811716 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m11:50:25.812721 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m11:50:25.812721 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m11:50:25.813719 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m11:50:25.814715 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m11:50:25.816711 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m11:50:25.816711 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m11:50:25.817708 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m11:50:25.817708 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m11:50:25.817708 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m11:50:25.818705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m11:50:25.818705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m11:50:25.820212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.product_performance)
[0m11:50:25.820212 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m11:50:25.821221 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m11:50:25.821221 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m11:50:25.822263 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m11:50:25.825256 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m11:50:25.828248 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m11:50:25.830749 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m11:50:25.833697 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m11:50:25.836129 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m11:50:25.836129 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m11:50:25.837133 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m11:50:25.838131 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m11:50:25.838131 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m11:50:25.839129 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m11:50:25.840126 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m11:50:25.840126 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m11:50:25.841257 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m11:50:25.842253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_day, now snapshot.ecommerce_project.sales_snapshot)
[0m11:50:25.843251 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m11:50:25.846241 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m11:50:25.847239 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m11:50:25.848237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:25.848237 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m11:50:25.849234 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m11:50:25.849234 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m11:50:25.850231 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m11:50:25.850231 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m11:50:25.850231 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m11:50:25.852333 [debug] [MainThread]: Command end result
[0m11:50:25.880173 [debug] [MainThread]: Command `dbt compile` succeeded at 11:50:25.880173 after 5.08 seconds
[0m11:50:25.880173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A12A7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199A73C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002199A49E2D0>]}
[0m11:50:25.881172 [debug] [MainThread]: Flushing usage events
[0m11:50:55.978223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A767FCE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A767FCF210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A767FCF010>]}


============================== 11:50:55.983718 | 10f0b113-0b5b-4494-9982-ea642e4e859a ==============================
[0m11:50:55.983718 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:50:55.983718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:50:56.047369 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:50:56.048391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '10f0b113-0b5b-4494-9982-ea642e4e859a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A767FCC810>]}
[0m11:50:56.214442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10f0b113-0b5b-4494-9982-ea642e4e859a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7680E0A90>]}
[0m11:50:56.278409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10f0b113-0b5b-4494-9982-ea642e4e859a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A765242F90>]}
[0m11:50:56.280007 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:50:56.288613 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:50:56.449932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:56.449932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:56.454925 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:50:56.491958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10f0b113-0b5b-4494-9982-ea642e4e859a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76828C150>]}
[0m11:50:56.628251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10f0b113-0b5b-4494-9982-ea642e4e859a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76960FE50>]}
[0m11:50:56.629248 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m11:50:56.630265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10f0b113-0b5b-4494-9982-ea642e4e859a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A768272A90>]}
[0m11:50:56.631739 [info ] [MainThread]: 
[0m11:50:56.632719 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:50:56.634232 [debug] [MainThread]: Command end result
[0m11:50:56.660251 [debug] [MainThread]: Command `dbt test` succeeded at 11:50:56.660251 after 0.76 seconds
[0m11:50:56.661473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A767CB0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A76149C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7611FE2D0>]}
[0m11:50:56.661473 [debug] [MainThread]: Flushing usage events
[0m11:51:06.151900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DA5BB190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DA5BB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DA60EF90>]}


============================== 11:51:06.155894 | ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e ==============================
[0m11:51:06.155894 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:51:06.155894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:06.218305 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:51:06.219812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DA1A4690>]}
[0m11:51:06.384741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DA720A90>]}
[0m11:51:06.445589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D7872F90>]}
[0m11:51:06.447491 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:51:06.456053 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:51:06.608828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:06.608828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:06.614414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:51:06.649964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DB942650>]}
[0m11:51:06.755138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DBAA6A50>]}
[0m11:51:06.756135 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m11:51:06.757134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DB896710>]}
[0m11:51:06.759128 [info ] [MainThread]: 
[0m11:51:06.760125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:51:06.764486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:51:06.860464 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:51:06.861463 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:51:06.861463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:07.252326 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.390 seconds
[0m11:51:07.254323 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:51:07.256339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m11:51:07.262833 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:51:07.262833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m11:51:07.263832 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:51:07.266825 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:51:07.266825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:07.267821 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:51:07.268817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:07.630597 [debug] [ThreadPool]: SQL status: BEGIN in 0.363 seconds
[0m11:51:07.632598 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:51:07.634583 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:51:07.645448 [debug] [ThreadPool]: SQL status: BEGIN in 0.377 seconds
[0m11:51:07.648348 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:51:07.650342 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:51:07.717583 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.065 seconds
[0m11:51:07.719582 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:51:07.726636 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.090 seconds
[0m11:51:07.728630 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:51:07.753230 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:51:07.760354 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:51:07.770386 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:07.770893 [debug] [MainThread]: On master: BEGIN
[0m11:51:07.770893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:08.078817 [debug] [MainThread]: SQL status: BEGIN in 0.308 seconds
[0m11:51:08.082563 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:08.085571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:51:08.150364 [debug] [MainThread]: SQL status: SELECT 3 in 0.062 seconds
[0m11:51:08.158402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DB868ED0>]}
[0m11:51:08.160391 [debug] [MainThread]: On master: ROLLBACK
[0m11:51:08.193106 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:08.195096 [debug] [MainThread]: On master: BEGIN
[0m11:51:08.248500 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m11:51:08.250520 [debug] [MainThread]: On master: COMMIT
[0m11:51:08.253000 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:08.256009 [debug] [MainThread]: On master: COMMIT
[0m11:51:08.289013 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m11:51:08.291650 [debug] [MainThread]: On master: Close
[0m11:51:08.295155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:51:08.295802 [info ] [MainThread]: 
[0m11:51:08.300322 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m11:51:08.300322 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m11:51:08.301428 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m11:51:08.301428 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m11:51:08.302556 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m11:51:08.303553 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m11:51:08.303553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_customers'
[0m11:51:08.304550 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m11:51:08.305548 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m11:51:08.305548 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m11:51:08.305548 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m11:51:08.307056 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m11:51:08.313570 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m11:51:08.316561 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m11:51:08.319554 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m11:51:08.321056 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m11:51:08.321056 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m11:51:08.351939 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m11:51:08.351939 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m11:51:08.355928 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m11:51:08.359410 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m11:51:08.362934 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:51:08.363958 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:51:08.363958 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:51:08.363958 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m11:51:08.364938 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m11:51:08.364938 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m11:51:08.365934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:51:08.366931 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:08.366931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:51:08.770291 [debug] [Thread-2 (]: SQL status: BEGIN in 0.404 seconds
[0m11:51:08.772412 [debug] [Thread-3 (]: SQL status: BEGIN in 0.405 seconds
[0m11:51:08.774439 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:51:08.776418 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:51:08.779407 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m11:51:08.782355 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m11:51:08.810957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.444 seconds
[0m11:51:08.811961 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:51:08.811961 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m11:51:08.825187 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m11:51:08.830683 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:51:08.830683 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:51:08.832570 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m11:51:08.836562 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:51:08.836562 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:51:08.860987 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m11:51:08.905308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.092 seconds
[0m11:51:08.906309 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:51:08.906309 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m11:51:08.910328 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:51:08.910328 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:51:08.913803 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:51:08.913803 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:51:08.914732 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:51:08.947000 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m11:51:08.947000 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m11:51:08.948001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m11:51:08.962012 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:51:08.963009 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:51:08.965995 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:51:08.966797 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:51:08.967351 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:51:08.967351 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:51:08.968351 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:51:08.968351 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:51:09.007830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m11:51:09.008842 [debug] [Thread-3 (]: SQL status: COMMIT in 0.039 seconds
[0m11:51:09.008842 [debug] [Thread-2 (]: SQL status: COMMIT in 0.039 seconds
[0m11:51:09.010401 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:51:09.016405 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m11:51:09.018383 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m11:51:09.019382 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:51:09.023372 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:51:09.024370 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:51:09.025312 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:51:09.025866 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m11:51:09.026436 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m11:51:09.060189 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m11:51:09.061218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m11:51:09.063576 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.036 seconds
[0m11:51:09.072228 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m11:51:09.080218 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m11:51:09.085274 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m11:51:09.090776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DC316110>]}
[0m11:51:09.092265 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:51:09.095264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DBEEA090>]}
[0m11:51:09.097262 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.78s]
[0m11:51:09.099253 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m11:51:09.100253 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.79s]
[0m11:51:09.101369 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m11:51:09.102366 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m11:51:09.103361 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m11:51:09.104362 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m11:51:09.104362 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m11:51:09.105358 [info ] [Thread-4 (]: 4 of 7 START sql table model public.category_performance ....................... [RUN]
[0m11:51:09.105358 [info ] [Thread-2 (]: 5 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m11:51:09.106355 [info ] [Thread-3 (]: 6 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m11:51:09.106355 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m11:51:09.107862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m11:51:09.107862 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m11:51:09.108871 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m11:51:09.108871 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m11:51:09.108871 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m11:51:09.112383 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m11:51:09.115375 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m11:51:09.118366 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m11:51:09.119364 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m11:51:09.119364 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m11:51:09.120361 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m11:51:09.141290 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m11:51:09.142291 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.040 seconds
[0m11:51:09.145282 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m11:51:09.148274 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m11:51:09.150268 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m11:51:09.151305 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:51:09.152305 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:51:09.152305 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:51:09.153302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DBE2F450>]}
[0m11:51:09.153302 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m11:51:09.154300 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m11:51:09.154300 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m11:51:09.155297 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.85s]
[0m11:51:09.156294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:51:09.156294 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:51:09.157291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:51:09.157291 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m11:51:09.159286 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m11:51:09.160283 [info ] [Thread-1 (]: 7 of 7 START sql table model public.product_performance ........................ [RUN]
[0m11:51:09.160283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.product_performance)
[0m11:51:09.161447 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m11:51:09.164441 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m11:51:09.165438 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m11:51:09.168430 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m11:51:09.169428 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:51:09.170425 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m11:51:09.170928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:09.501484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.345 seconds
[0m11:51:09.503694 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:51:09.506687 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m11:51:09.510220 [debug] [Thread-4 (]: SQL status: BEGIN in 0.353 seconds
[0m11:51:09.511753 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:51:09.514766 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    WITH category_sales AS (
    SELECT
        p.category,
        sum(s.quantity) AS total_sales,
        SUM(s.total_price) AS total_revenue,
        AVG(p.price) AS avg_price
    FROM "d9snqvovhsjpqs"."public"."stg_sales" s
    join "d9snqvovhsjpqs"."public"."stg_products" p
        on s.product_id= p.product_id
    GROUP BY p.category
)

SELECT
    category,
    total_sales,
    total_revenue,
    avg_price
from category_sales
order by total_revenue desc
  );
  
[0m11:51:09.563497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.406 seconds
[0m11:51:09.566490 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:51:09.568480 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m11:51:09.574985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.404 seconds
[0m11:51:09.577993 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:51:09.580623 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m11:51:09.666658 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.150 seconds
[0m11:51:09.668662 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.160 seconds
[0m11:51:09.679352 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:51:09.680377 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.098 seconds
[0m11:51:09.681835 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.111 seconds
[0m11:51:09.691452 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:51:09.692917 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m11:51:09.695912 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:51:09.697906 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:51:09.698903 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m11:51:09.698903 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m11:51:09.700488 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m11:51:09.724020 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m11:51:09.736612 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:51:09.737621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m11:51:09.738609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m11:51:09.740214 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m11:51:09.741198 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m11:51:09.747459 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:51:09.753935 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:51:09.758920 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:51:09.761472 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m11:51:09.762470 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m11:51:09.763466 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m11:51:09.795227 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m11:51:09.800266 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m11:51:09.800358 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:51:09.801355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m11:51:09.801355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m11:51:09.801355 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m11:51:09.802624 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m11:51:09.803994 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:51:09.805381 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:51:09.806684 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:51:09.806684 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:51:09.807681 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:51:09.807681 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:51:09.809024 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:51:09.809024 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:51:09.809024 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:51:09.848049 [debug] [Thread-3 (]: SQL status: COMMIT in 0.037 seconds
[0m11:51:09.848049 [debug] [Thread-4 (]: SQL status: COMMIT in 0.042 seconds
[0m11:51:09.849056 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m11:51:09.849056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m11:51:09.851147 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m11:51:09.854140 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m11:51:09.855408 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m11:51:09.858402 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m11:51:09.860407 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:51:09.861876 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:51:09.862872 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:51:09.862872 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:51:09.863870 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m11:51:09.864876 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m11:51:09.864876 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m11:51:09.865865 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m11:51:09.903916 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.037 seconds
[0m11:51:09.910415 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m11:51:09.912931 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DA1A4D50>]}
[0m11:51:09.915922 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.81s]
[0m11:51:09.917916 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.051 seconds
[0m11:51:09.918920 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.052 seconds
[0m11:51:09.918920 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.053 seconds
[0m11:51:09.921498 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m11:51:09.924862 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m11:51:09.927856 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m11:51:09.928855 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m11:51:09.931378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DC2EB0D0>]}
[0m11:51:09.932658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DBE15A50>]}
[0m11:51:09.933748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09ac3c-ba0f-4f9e-94fa-d1fa0ec3ce6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DBE58E90>]}
[0m11:51:09.934749 [info ] [Thread-4 (]: 4 of 7 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.83s]
[0m11:51:09.935746 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.82s]
[0m11:51:09.937744 [info ] [Thread-1 (]: 7 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.77s]
[0m11:51:09.938750 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m11:51:09.938750 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m11:51:09.940339 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m11:51:09.943494 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:09.943494 [debug] [MainThread]: On master: BEGIN
[0m11:51:09.944491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:10.323360 [debug] [MainThread]: SQL status: BEGIN in 0.379 seconds
[0m11:51:10.326362 [debug] [MainThread]: On master: COMMIT
[0m11:51:10.328343 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:10.330338 [debug] [MainThread]: On master: COMMIT
[0m11:51:10.366981 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m11:51:10.369004 [debug] [MainThread]: On master: Close
[0m11:51:10.372877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:10.374858 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs' was properly closed.
[0m11:51:10.374858 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m11:51:10.374858 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m11:51:10.375856 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m11:51:10.375856 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m11:51:10.376853 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m11:51:10.376853 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m11:51:10.377857 [info ] [MainThread]: 
[0m11:51:10.377857 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m11:51:10.380365 [debug] [MainThread]: Command end result
[0m11:51:10.408929 [info ] [MainThread]: 
[0m11:51:10.408929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:10.410436 [info ] [MainThread]: 
[0m11:51:10.410804 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:51:10.412485 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:10.412485 after 4.34 seconds
[0m11:51:10.412485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D3AEC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D384E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D384F390>]}
[0m11:51:10.413482 [debug] [MainThread]: Flushing usage events
[0m11:52:25.268629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3BBB250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3C12790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3C12690>]}


============================== 11:52:25.274218 | e48efe6f-6022-4f5d-ad01-aaca78b3ad79 ==============================
[0m11:52:25.274218 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:52:25.275216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:52:25.346463 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:52:25.346887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3D0EDD0>]}
[0m11:52:25.517611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3D64610>]}
[0m11:52:25.581835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE0E7F050>]}
[0m11:52:25.583834 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:52:25.593388 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:52:25.756145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:52:25.757142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:52:25.762182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:52:25.800187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3BFD510>]}
[0m11:52:25.907846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE50A6CD0>]}
[0m11:52:25.908843 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m11:52:25.908843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3E9AA10>]}
[0m11:52:25.911402 [info ] [MainThread]: 
[0m11:52:25.913406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:25.917785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:52:26.022863 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:52:26.022863 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:52:26.023860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:26.414403 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.390 seconds
[0m11:52:26.415403 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:52:26.417398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m11:52:26.418396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m11:52:26.424043 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:52:26.426039 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:52:26.426792 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:52:26.427366 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:52:26.427910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:26.427910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:26.746683 [debug] [ThreadPool]: SQL status: BEGIN in 0.319 seconds
[0m11:52:26.749090 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:52:26.751723 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:52:26.766616 [debug] [ThreadPool]: SQL status: BEGIN in 0.339 seconds
[0m11:52:26.768626 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:52:26.771265 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:52:26.789542 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.035 seconds
[0m11:52:26.796711 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:52:26.806576 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.033 seconds
[0m11:52:26.809555 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:52:26.827119 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:52:26.843106 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:52:26.854290 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:26.855285 [debug] [MainThread]: On master: BEGIN
[0m11:52:26.856282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:27.208707 [debug] [MainThread]: SQL status: BEGIN in 0.352 seconds
[0m11:52:27.211371 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:27.213369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:52:27.266051 [debug] [MainThread]: SQL status: SELECT 3 in 0.051 seconds
[0m11:52:27.268048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE543FA90>]}
[0m11:52:27.268048 [debug] [MainThread]: On master: ROLLBACK
[0m11:52:27.297571 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:27.298575 [debug] [MainThread]: On master: BEGIN
[0m11:52:27.347007 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m11:52:27.348003 [debug] [MainThread]: On master: COMMIT
[0m11:52:27.349000 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:27.350637 [debug] [MainThread]: On master: COMMIT
[0m11:52:27.392094 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m11:52:27.394087 [debug] [MainThread]: On master: Close
[0m11:52:27.396082 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:27.398074 [info ] [MainThread]: 
[0m11:52:27.401992 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m11:52:27.401992 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m11:52:27.403247 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m11:52:27.403247 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m11:52:27.404246 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m11:52:27.405245 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m11:52:27.405245 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_customers'
[0m11:52:27.406266 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m11:52:27.407238 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m11:52:27.407238 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m11:52:27.408236 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m11:52:27.408236 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m11:52:27.415726 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m11:52:27.417720 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m11:52:27.420314 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m11:52:27.422494 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m11:52:27.422494 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m11:52:27.452708 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m11:52:27.452708 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m11:52:27.456769 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m11:52:27.460681 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m11:52:27.461678 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:52:27.462679 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:52:27.463676 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m11:52:27.463676 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:52:27.464673 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m11:52:27.464673 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:52:27.465670 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m11:52:27.465670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:52:27.466667 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:52:27.816450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.352 seconds
[0m11:52:27.818444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.351 seconds
[0m11:52:27.820992 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:52:27.822993 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:52:27.825010 [debug] [Thread-2 (]: SQL status: BEGIN in 0.359 seconds
[0m11:52:27.826983 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m11:52:27.830610 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m11:52:27.832960 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:52:27.837948 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m11:52:27.907584 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.070 seconds
[0m11:52:27.908579 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.069 seconds
[0m11:52:27.910579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.075 seconds
[0m11:52:27.928664 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:52:27.933130 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:52:27.975002 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:52:27.976000 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:52:27.976279 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:52:27.976880 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:52:28.005748 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m11:52:28.008742 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:52:28.008742 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:52:28.008742 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m11:52:28.012575 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:52:28.012575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m11:52:28.013572 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:52:28.016565 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:52:28.016565 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:52:28.036601 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m11:52:28.051137 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:52:28.052139 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:52:28.052139 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:52:28.069179 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m11:52:28.069179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m11:52:28.071268 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:52:28.072324 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:52:28.073324 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:52:28.073324 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:52:28.074321 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:52:28.074321 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:52:28.079164 [debug] [Thread-3 (]: SQL status: COMMIT in 0.027 seconds
[0m11:52:28.084826 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m11:52:28.088816 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:52:28.090321 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m11:52:28.101171 [debug] [Thread-2 (]: SQL status: COMMIT in 0.026 seconds
[0m11:52:28.110399 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m11:52:28.110399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m11:52:28.112833 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:52:28.117996 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m11:52:28.118994 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.028 seconds
[0m11:52:28.118994 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m11:52:28.120523 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:52:28.122843 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m11:52:28.123856 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m11:52:28.125665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE545BF10>]}
[0m11:52:28.126662 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.72s]
[0m11:52:28.127660 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m11:52:28.128657 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m11:52:28.128657 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m11:52:28.128657 [info ] [Thread-4 (]: 4 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m11:52:28.130237 [info ] [Thread-3 (]: 5 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m11:52:28.131233 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m11:52:28.131233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m11:52:28.132349 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m11:52:28.133348 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m11:52:28.135343 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m11:52:28.138335 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m11:52:28.139357 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m11:52:28.139357 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m11:52:28.160301 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m11:52:28.161299 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.038 seconds
[0m11:52:28.161299 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m11:52:28.165600 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m11:52:28.166866 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m11:52:28.167829 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:52:28.168829 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m11:52:28.170336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE50C68D0>]}
[0m11:52:28.170336 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:52:28.171515 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m11:52:28.171515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE543E4D0>]}
[0m11:52:28.172516 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.76s]
[0m11:52:28.173512 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m11:52:28.173512 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:52:28.174509 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.77s]
[0m11:52:28.175507 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m11:52:28.176504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:52:28.177502 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m11:52:28.178500 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m11:52:28.179498 [debug] [Thread-1 (]: Began running node model.ecommerce_project.category_performance
[0m11:52:28.180494 [info ] [Thread-2 (]: 6 of 7 START sql table model public.product_performance ........................ [RUN]
[0m11:52:28.180999 [info ] [Thread-1 (]: 7 of 7 START sql table model public.category_performance ....................... [RUN]
[0m11:52:28.180999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m11:52:28.182095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.category_performance)
[0m11:52:28.183095 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m11:52:28.183095 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.category_performance
[0m11:52:28.186087 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m11:52:28.189079 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m11:52:28.190586 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m11:52:28.191869 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.category_performance
[0m11:52:28.194864 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m11:52:28.197855 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m11:52:28.198853 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:52:28.200432 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:52:28.203131 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m11:52:28.204547 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: BEGIN
[0m11:52:28.205547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:52:28.205547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:28.509753 [debug] [Thread-3 (]: SQL status: BEGIN in 0.333 seconds
[0m11:52:28.511327 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:52:28.511327 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m11:52:28.517561 [debug] [Thread-4 (]: SQL status: BEGIN in 0.343 seconds
[0m11:52:28.518566 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:52:28.518566 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m11:52:28.572631 [debug] [Thread-2 (]: SQL status: BEGIN in 0.367 seconds
[0m11:52:28.575630 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:52:28.576628 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m11:52:28.577622 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.065 seconds
[0m11:52:28.580125 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:52:28.581134 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m11:52:28.598678 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.078 seconds
[0m11:52:28.599134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.393 seconds
[0m11:52:28.602418 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:52:28.603169 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:52:28.603834 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m11:52:28.604834 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    WITH category_sales AS (
    SELECT
        p.category,
        sum(s.quantity) AS total_sales,
        SUM(s.total_price) AS total_revenue,
        AVG(p.price) AS avg_price
    FROM "d9snqvovhsjpqs"."public"."stg_sales" s
    join "d9snqvovhsjpqs"."public"."stg_products" p
        on s.product_id= p.product_id
    GROUP BY p.category
)

SELECT
    category,
    total_sales,
    total_revenue,
    avg_price
from category_sales
order by total_revenue desc
  );
  
[0m11:52:28.615568 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m11:52:28.628249 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:52:28.630247 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m11:52:28.633533 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m11:52:28.642108 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:52:28.644117 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m11:52:28.647105 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.069 seconds
[0m11:52:28.653716 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:52:28.654712 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m11:52:28.666173 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m11:52:28.672668 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:52:28.672668 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.068 seconds
[0m11:52:28.673665 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m11:52:28.673665 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:52:28.677728 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:52:28.681284 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:52:28.682753 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:52:28.683750 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m11:52:28.684698 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:52:28.686504 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:52:28.688257 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m11:52:28.691324 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:52:28.692324 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m11:52:28.714513 [debug] [Thread-4 (]: SQL status: COMMIT in 0.028 seconds
[0m11:52:28.714513 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m11:52:28.717507 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m11:52:28.719500 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m11:52:28.722534 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:52:28.723534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m11:52:28.723534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m11:52:28.724529 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:52:28.725526 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m11:52:28.728519 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:52:28.729516 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:52:28.730514 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m11:52:28.731567 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m11:52:28.731567 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:52:28.732565 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:52:28.768561 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.038 seconds
[0m11:52:28.769269 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m11:52:28.769269 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.037 seconds
[0m11:52:28.770275 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m11:52:28.773573 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m11:52:28.775150 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m11:52:28.776148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE53997D0>]}
[0m11:52:28.776148 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:52:28.777145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3D22010>]}
[0m11:52:28.777718 [info ] [Thread-4 (]: 4 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.64s]
[0m11:52:28.777718 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m11:52:28.778720 [info ] [Thread-3 (]: 5 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.65s]
[0m11:52:28.780228 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m11:52:28.781243 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m11:52:28.784239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m11:52:28.786234 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: COMMIT
[0m11:52:28.787231 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:52:28.787231 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: COMMIT
[0m11:52:28.830466 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.050 seconds
[0m11:52:28.832481 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m11:52:28.833478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3D45710>]}
[0m11:52:28.833478 [info ] [Thread-2 (]: 6 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.65s]
[0m11:52:28.834475 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m11:52:28.881727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m11:52:28.885711 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m11:52:28.887706 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m11:52:28.888703 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m11:52:28.936124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.047 seconds
[0m11:52:28.938142 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: Close
[0m11:52:28.939119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48efe6f-6022-4f5d-ad01-aaca78b3ad79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE3E7B450>]}
[0m11:52:28.939119 [info ] [Thread-1 (]: 7 of 7 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.76s]
[0m11:52:28.941220 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.category_performance
[0m11:52:28.942397 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:28.943399 [debug] [MainThread]: On master: BEGIN
[0m11:52:28.943399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:29.354513 [debug] [MainThread]: SQL status: BEGIN in 0.411 seconds
[0m11:52:29.356552 [debug] [MainThread]: On master: COMMIT
[0m11:52:29.358550 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:29.360181 [debug] [MainThread]: On master: COMMIT
[0m11:52:29.392125 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m11:52:29.393134 [debug] [MainThread]: On master: Close
[0m11:52:29.395147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:29.396124 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs' was properly closed.
[0m11:52:29.397119 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m11:52:29.398117 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m11:52:29.399114 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m11:52:29.400625 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m11:52:29.402047 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m11:52:29.403053 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m11:52:29.404059 [info ] [MainThread]: 
[0m11:52:29.404495 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m11:52:29.406494 [debug] [MainThread]: Command end result
[0m11:52:29.433983 [info ] [MainThread]: 
[0m11:52:29.434993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:29.436595 [info ] [MainThread]: 
[0m11:52:29.437602 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:52:29.439115 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:29.438609 after 4.25 seconds
[0m11:52:29.439649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDD12C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDCE8E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDCE8E2D0>]}
[0m11:52:29.440157 [debug] [MainThread]: Flushing usage events
[0m21:27:15.849949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4773C6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47736E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4773C42D0>]}


============================== 21:27:15.895940 | a4c18f06-9280-42c0-a96d-2c127f0659b6 ==============================
[0m21:27:15.895940 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:27:15.896941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'debug': 'False', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:27:15.994742 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:27:15.995739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F476F64890>]}
[0m21:27:16.223487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47755A250>]}
[0m21:27:16.288832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F474642FD0>]}
[0m21:27:16.291021 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:27:16.310720 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:27:17.325163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:17.326161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:17.332178 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:27:17.368051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4786B8A90>]}
[0m21:27:17.491478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4788669D0>]}
[0m21:27:17.492477 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m21:27:17.492477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478655210>]}
[0m21:27:17.494472 [info ] [MainThread]: 
[0m21:27:17.495469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:17.500379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:27:19.660911 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:27:19.660911 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:27:19.661907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:20.197529 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.536 seconds
[0m21:27:20.203515 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:27:20.208504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:27:20.210497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:27:20.217475 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:27:20.219469 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:27:20.219469 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:27:20.220466 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:27:20.220466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:20.221464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:20.569396 [debug] [ThreadPool]: SQL status: BEGIN in 0.348 seconds
[0m21:27:20.569396 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:27:20.570392 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:27:20.606189 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m21:27:20.608184 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:27:20.614167 [debug] [ThreadPool]: SQL status: BEGIN in 0.393 seconds
[0m21:27:20.615166 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:27:20.615166 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:27:20.638145 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:27:20.661110 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.046 seconds
[0m21:27:20.663104 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:27:20.711546 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:27:20.719546 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:20.720567 [debug] [MainThread]: On master: BEGIN
[0m21:27:20.720567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:21.128169 [debug] [MainThread]: SQL status: BEGIN in 0.407 seconds
[0m21:27:21.128169 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.129167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:21.186377 [debug] [MainThread]: SQL status: SELECT 4 in 0.057 seconds
[0m21:27:21.189526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478BD2E90>]}
[0m21:27:21.189526 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:21.216166 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.216812 [debug] [MainThread]: On master: BEGIN
[0m21:27:21.313497 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m21:27:21.314494 [debug] [MainThread]: On master: COMMIT
[0m21:27:21.315493 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:21.315493 [debug] [MainThread]: On master: COMMIT
[0m21:27:21.345452 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m21:27:21.345452 [debug] [MainThread]: On master: Close
[0m21:27:21.346449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:21.347447 [info ] [MainThread]: 
[0m21:27:21.352433 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:27:21.352433 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:27:21.353219 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:27:21.353219 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m21:27:21.354221 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m21:27:21.355216 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_customers'
[0m21:27:21.354221 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m21:27:21.356213 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m21:27:21.357212 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:27:21.358211 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:27:21.358211 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:27:21.365195 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:27:21.366192 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:27:21.369211 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:27:21.371176 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:27:21.389691 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:27:21.389691 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:27:21.390689 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:27:21.421338 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:27:21.427323 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:27:21.431311 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:27:21.456503 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:21.456503 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:21.457500 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:21.458071 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:27:21.458451 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:27:21.459000 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:27:21.459538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:21.460080 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:27:21.460611 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:21.941523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.482 seconds
[0m21:27:21.941523 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:21.942521 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:27:21.960478 [debug] [Thread-3 (]: SQL status: BEGIN in 0.500 seconds
[0m21:27:21.961474 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:21.962470 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:27:22.007782 [debug] [Thread-2 (]: SQL status: BEGIN in 0.548 seconds
[0m21:27:22.008780 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:22.009777 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:27:22.009777 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m21:27:22.015762 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:22.016759 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:27:22.031719 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.069 seconds
[0m21:27:22.035707 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:22.036706 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:27:22.064634 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m21:27:22.064634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:27:22.112755 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:22.112755 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.076 seconds
[0m21:27:22.115749 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:22.116744 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:27:22.119737 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:22.120735 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:27:22.120735 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:27:22.163291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m21:27:22.163901 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:27:22.163901 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m21:27:22.179249 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:27:22.180776 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:27:22.183769 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:22.184427 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:22.185025 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:22.185576 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:27:22.186141 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:27:22.186675 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:27:22.211308 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.024 seconds
[0m21:27:22.218298 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:27:22.220292 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:22.222285 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:27:22.223283 [debug] [Thread-3 (]: SQL status: COMMIT in 0.036 seconds
[0m21:27:22.225279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m21:27:22.237152 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:27:22.241140 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:27:22.248120 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:22.249118 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:22.249118 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:27:22.250184 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:27:22.278650 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m21:27:22.286625 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:27:22.287622 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.036 seconds
[0m21:27:22.288619 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:22.293609 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:27:22.294606 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:27:22.297597 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47749A310>]}
[0m21:27:22.298592 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.94s]
[0m21:27:22.300589 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:27:22.301485 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:27:22.301485 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:27:22.302485 [info ] [Thread-4 (]: 4 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m21:27:22.303299 [info ] [Thread-3 (]: 5 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m21:27:22.304300 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m21:27:22.304300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m21:27:22.305296 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:27:22.306296 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:27:22.309287 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:27:22.311291 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:27:22.324652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.074 seconds
[0m21:27:22.379391 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.081 seconds
[0m21:27:23.076988 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:27:23.078984 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:27:23.080975 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:27:23.086997 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:27:23.091956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478BF0490>]}
[0m21:27:23.159765 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:27:23.163754 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:27:23.165750 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4790FEED0>]}
[0m21:27:23.165750 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 1.74s]
[0m21:27:23.167744 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 1.81s]
[0m21:27:23.167744 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:27:23.168742 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:27:23.169738 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m21:27:23.170735 [debug] [Thread-2 (]: Began running node model.ecommerce_project.category_performance
[0m21:27:23.170735 [info ] [Thread-1 (]: 6 of 7 START sql table model public.product_performance ........................ [RUN]
[0m21:27:23.171732 [info ] [Thread-2 (]: 7 of 7 START sql table model public.category_performance ....................... [RUN]
[0m21:27:23.172730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.product_performance)
[0m21:27:23.172730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.category_performance)
[0m21:27:23.174238 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:27:23.175238 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:27:23.178231 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:27:23.181223 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:27:23.183217 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m21:27:23.183217 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.category_performance
[0m21:27:23.187206 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:27:23.191195 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:27:23.192192 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:23.192192 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:23.193190 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:23.194187 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:27:23.194187 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:23.195186 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:27:23.195186 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:27:23.196182 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:27:23.196182 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:27:23.197179 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:27:23.198177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:23.200172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:23.731393 [debug] [Thread-4 (]: SQL status: BEGIN in 0.535 seconds
[0m21:27:23.742363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.544 seconds
[0m21:27:23.742363 [debug] [Thread-3 (]: SQL status: BEGIN in 0.545 seconds
[0m21:27:23.743360 [debug] [Thread-2 (]: SQL status: BEGIN in 0.543 seconds
[0m21:27:24.083316 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:24.083316 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:24.084314 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:24.084314 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:24.085311 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:27:24.085311 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:27:24.086308 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:27:24.087306 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    WITH category_sales AS (
    SELECT
        p.category,
        sum(s.quantity) AS total_sales,
        SUM(s.total_price) AS total_revenue,
        AVG(p.price) AS avg_price
    FROM "d9snqvovhsjpqs"."public"."stg_sales" s
    join "d9snqvovhsjpqs"."public"."stg_products" p
        on s.product_id= p.product_id
    GROUP BY p.category
)

SELECT
    category,
    total_sales,
    total_revenue,
    avg_price
from category_sales
order by total_revenue desc
  );
  
[0m21:27:24.191639 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.104 seconds
[0m21:27:24.192637 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.105 seconds
[0m21:27:24.192637 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.105 seconds
[0m21:27:24.192637 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.105 seconds
[0m21:27:24.195629 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:24.198622 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:24.201613 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:24.204605 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:24.205602 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:27:24.206601 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:27:24.207598 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:27:24.207598 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:27:24.237517 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:27:24.242505 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:24.243510 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:27:24.243510 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:27:24.244498 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:27:24.244498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:27:24.247491 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:24.252477 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:24.255471 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:24.256469 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:27:24.256469 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:27:24.257466 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:27:24.288892 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m21:27:24.293879 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:27:24.293879 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:27:24.294877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:27:24.294877 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:27:24.573561 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:24.575565 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:27:24.577072 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:27:24.578071 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:27:24.579069 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:27:24.580067 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:24.580067 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:24.581205 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:24.581792 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:27:24.582842 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:27:24.582842 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:27:24.625669 [debug] [Thread-2 (]: SQL status: COMMIT in 0.042 seconds
[0m21:27:24.626674 [debug] [Thread-3 (]: SQL status: COMMIT in 0.045 seconds
[0m21:27:24.627671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m21:27:24.627671 [debug] [Thread-4 (]: SQL status: COMMIT in 0.044 seconds
[0m21:27:24.633059 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:27:24.638003 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:27:24.642992 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:27:24.647989 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:27:24.653963 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:24.654958 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:24.656957 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:24.658947 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:24.659944 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:27:24.660942 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:27:24.662162 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:27:24.663421 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:27:24.700488 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.035 seconds
[0m21:27:24.705483 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:27:24.708480 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4790DCC90>]}
[0m21:27:24.709471 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:27:24.710471 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:27:24.711855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:27:24.713859 [info ] [Thread-3 (]: 5 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 2.40s]
[0m21:27:24.717850 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: Close
[0m21:27:24.723837 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:27:24.727821 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m21:27:24.729816 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:27:24.731809 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47713DF90>]}
[0m21:27:24.732811 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F476992350>]}
[0m21:27:24.734801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c18f06-9280-42c0-a96d-2c127f0659b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478BD0990>]}
[0m21:27:24.737732 [info ] [Thread-2 (]: 7 of 7 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 1.56s]
[0m21:27:24.739738 [info ] [Thread-4 (]: 4 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 2.43s]
[0m21:27:24.742860 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.category_performance
[0m21:27:24.744871 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:27:24.741721 [info ] [Thread-1 (]: 6 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 1.56s]
[0m21:27:24.797419 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m21:27:24.799413 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:24.799413 [debug] [MainThread]: On master: BEGIN
[0m21:27:24.800410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:25.153095 [debug] [MainThread]: SQL status: BEGIN in 0.353 seconds
[0m21:27:25.555006 [debug] [MainThread]: On master: COMMIT
[0m21:27:25.557008 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:25.559000 [debug] [MainThread]: On master: COMMIT
[0m21:27:25.587527 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m21:27:25.588529 [debug] [MainThread]: On master: Close
[0m21:27:25.589525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:25.589525 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs' was properly closed.
[0m21:27:25.590523 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m21:27:25.590523 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m21:27:25.591520 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:27:25.591520 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m21:27:25.591520 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:27:25.592517 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m21:27:25.593514 [info ] [MainThread]: 
[0m21:27:25.593514 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m21:27:25.595493 [debug] [MainThread]: Command end result
[0m21:27:25.624446 [info ] [MainThread]: 
[0m21:27:25.625420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:25.626409 [info ] [MainThread]: 
[0m21:27:25.627407 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:27:25.628405 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:25.628405 after 9.91 seconds
[0m21:27:25.629402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47089C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4705FE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4705FF390>]}
[0m21:27:25.630400 [debug] [MainThread]: Flushing usage events
[0m21:34:47.905794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C54060390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C54062C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C53ED2550>]}


============================== 21:34:47.909784 | 40a5ca7c-417a-4488-90fb-f08aa9458ffe ==============================
[0m21:34:47.909784 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:34:47.910783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:34:47.978633 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:34:47.979629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5409FA90>]}
[0m21:34:48.155015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5404D490>]}
[0m21:34:48.229484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C512D30D0>]}
[0m21:34:48.231638 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:34:48.239986 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:34:48.400468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m21:34:48.401975 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\customer_order_frequency.sql
[0m21:34:48.401975 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\monthly_revenue_orders.sql
[0m21:34:48.402982 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models\marts\sales_reporting\customer_lifetime_value.sql
[0m21:34:48.651622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:34:48.662673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C55501CD0>]}
[0m21:34:48.768312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5565CA50>]}
[0m21:34:48.768312 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:34:48.769310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C542BD9D0>]}
[0m21:34:48.771900 [info ] [MainThread]: 
[0m21:34:48.772897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:48.778115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:34:48.917152 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:34:48.917152 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:34:48.918148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:49.862024 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.944 seconds
[0m21:34:49.863021 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:34:49.866165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:34:49.866165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:34:49.871151 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:34:49.873652 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:34:49.873652 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:34:49.874652 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:34:49.875649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:49.875649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:50.559711 [debug] [ThreadPool]: SQL status: BEGIN in 0.684 seconds
[0m21:34:50.560717 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:34:50.560717 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:34:50.622019 [debug] [ThreadPool]: SQL status: BEGIN in 0.746 seconds
[0m21:34:50.623021 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.060 seconds
[0m21:34:50.623021 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:34:50.626019 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:34:50.627015 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:34:50.674482 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m21:34:50.676761 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:34:50.680758 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:34:50.741098 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:34:50.749177 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:50.751171 [debug] [MainThread]: On master: BEGIN
[0m21:34:50.751171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:51.579237 [debug] [MainThread]: SQL status: BEGIN in 0.828 seconds
[0m21:34:51.581909 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:51.584176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:51.729166 [debug] [MainThread]: SQL status: SELECT 4 in 0.145 seconds
[0m21:34:51.739574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C554E2710>]}
[0m21:34:51.742248 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:51.791999 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:51.794007 [debug] [MainThread]: On master: BEGIN
[0m21:34:52.042236 [debug] [MainThread]: SQL status: BEGIN in 0.245 seconds
[0m21:34:52.044237 [debug] [MainThread]: On master: COMMIT
[0m21:34:52.047236 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:52.049230 [debug] [MainThread]: On master: COMMIT
[0m21:34:52.203847 [debug] [MainThread]: SQL status: COMMIT in 0.152 seconds
[0m21:34:52.207230 [debug] [MainThread]: On master: Close
[0m21:34:52.210225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:52.213649 [info ] [MainThread]: 
[0m21:34:52.224699 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:34:52.225706 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:34:52.226702 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:34:52.228695 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m21:34:52.229693 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_products ............................... [RUN]
[0m21:34:52.230688 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m21:34:52.230688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_customers'
[0m21:34:52.232195 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m21:34:52.232195 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:34:52.233229 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:34:52.234226 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:34:52.234226 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:34:52.243841 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:34:52.246835 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:34:52.249828 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:34:52.250825 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:34:52.251823 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:34:52.283589 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:34:52.284588 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:34:52.288578 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:34:52.291927 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:34:52.292433 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:34:52.292433 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:34:52.293871 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:34:52.293871 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:34:52.294871 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:34:52.294871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:34:52.295867 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:34:52.295867 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:52.296865 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:34:53.943261 [debug] [Thread-3 (]: SQL status: BEGIN in 1.646 seconds
[0m21:34:53.945727 [debug] [Thread-2 (]: SQL status: BEGIN in 1.649 seconds
[0m21:34:53.947719 [debug] [Thread-1 (]: SQL status: BEGIN in 1.652 seconds
[0m21:34:53.949713 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:34:53.952215 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:34:53.954511 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:34:53.957499 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:34:53.960495 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:34:53.963078 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:34:54.089491 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.123 seconds
[0m21:34:54.089491 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.125 seconds
[0m21:34:54.089491 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.123 seconds
[0m21:34:54.096441 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:34:54.099433 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:34:54.102994 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:34:54.103994 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:34:54.103994 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:34:54.104990 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:34:54.153433 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:34:54.154435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:34:54.154435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:34:54.158424 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:34:54.160420 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:34:54.162971 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:34:54.164164 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:34:54.164778 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:34:54.164778 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:34:54.381788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.215 seconds
[0m21:34:54.382830 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.217 seconds
[0m21:34:54.385113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.218 seconds
[0m21:34:54.423479 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:34:54.425472 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:34:54.427465 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:34:54.428463 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:34:54.428463 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:34:54.429461 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:34:54.430458 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:34:54.430458 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:34:54.432031 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:34:54.534705 [debug] [Thread-3 (]: SQL status: COMMIT in 0.102 seconds
[0m21:34:54.536474 [debug] [Thread-2 (]: SQL status: COMMIT in 0.104 seconds
[0m21:34:54.538521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.106 seconds
[0m21:34:54.559318 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:34:54.563882 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:34:54.567318 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:34:54.573892 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:34:54.574892 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:34:54.575888 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:34:54.576886 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:34:54.576886 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:34:54.577882 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:34:54.660266 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.081 seconds
[0m21:34:54.661849 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.083 seconds
[0m21:34:54.662862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.084 seconds
[0m21:34:54.672581 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:34:54.678617 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:34:54.684452 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:34:54.692061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C559A2D10>]}
[0m21:34:54.695473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C54204950>]}
[0m21:34:54.697467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C559B28D0>]}
[0m21:34:54.700459 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 2.46s]
[0m21:34:54.703042 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 2.46s]
[0m21:34:54.706201 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 2.47s]
[0m21:34:54.709192 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:34:54.711702 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:34:54.712731 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:34:54.715217 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:34:54.716217 [debug] [Thread-3 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:34:54.717214 [debug] [Thread-2 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:34:54.718213 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:34:54.719209 [info ] [Thread-4 (]: 4 of 10 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:34:54.720204 [info ] [Thread-3 (]: 5 of 10 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:34:54.721713 [info ] [Thread-2 (]: 6 of 10 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:34:54.722761 [info ] [Thread-1 (]: 7 of 10 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:34:54.724058 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m21:34:54.724058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.customer_order_frequency)
[0m21:34:54.725053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.monthly_revenue_orders)
[0m21:34:54.726051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m21:34:54.726051 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:34:54.727048 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:34:54.727048 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:34:54.728051 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:34:54.731037 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:34:54.733536 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:34:54.735533 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:54.738525 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:34:54.740520 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:34:54.740520 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:34:54.742026 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:34:54.762436 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:34:54.763455 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:34:54.766449 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:34:54.770439 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:54.774968 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:34:54.775966 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:34:54.776962 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:34:54.777961 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:54.777961 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:34:54.778959 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:34:54.779956 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:34:54.779956 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:34:54.780952 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:34:54.780952 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:34:54.781948 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:34:54.781948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:34:54.783034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:56.195848 [debug] [Thread-1 (]: SQL status: BEGIN in 1.413 seconds
[0m21:34:56.196850 [debug] [Thread-2 (]: SQL status: BEGIN in 1.414 seconds
[0m21:34:56.197846 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:34:56.198845 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:56.198845 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:34:56.199841 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    with monthly_revenue_orders as (
    select
        TO_CHAR(order_date, 'YY-MM') as month,
    count(DISTINCT order_id) as total_order,
    sum(total_price) as total_revenue
    from"d9snqvovhsjpqs"."public"."stg_sales"
    group by month
)

select
    month,
    total_order,
    total_revenue
from monthly_revenue_orders
order by month
  );
  
[0m21:34:56.315462 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.115 seconds
[0m21:34:56.317457 [debug] [Thread-4 (]: SQL status: BEGIN in 1.536 seconds
[0m21:34:56.319494 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.118 seconds
[0m21:34:56.320457 [debug] [Thread-3 (]: SQL status: BEGIN in 1.539 seconds
[0m21:34:56.333613 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:34:56.336625 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:34:56.346344 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:56.348335 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:34:56.349330 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:34:56.350329 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:34:56.351841 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:34:56.352875 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    with customer_order_frequency as (
    select
        customer_id,
        count(distinct order_id) as total_orders,
        min(order_date) as first_order,
        max(order_date) as last_order,
        (Max(order_date) - Min(order_date)) as total_days_intervals,
        count(distinct order_date) -1 as order_intervals
    from "d9snqvovhsjpqs"."public"."stg_sales"
    group by customer_id
)

Select
    customer_id,
    total_orders,
    first_order,
    last_order,
    case
        when order_intervals > 0 then
        total_days_intervals::FLOAT / order_intervals::FLOAT
        else NULL
    end as avg_days_between_orders
from customer_order_frequency
  );
  
[0m21:34:56.522207 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.166 seconds
[0m21:34:56.523230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.168 seconds
[0m21:34:56.523230 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.167 seconds
[0m21:34:56.524231 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.168 seconds
[0m21:34:56.526225 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:56.529216 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:34:56.532220 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:34:56.535668 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:34:56.535668 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:34:56.536665 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:34:56.537663 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency" rename to "customer_order_frequency__dbt_backup"
[0m21:34:56.537663 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:34:56.693519 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m21:34:56.695520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.156 seconds
[0m21:34:56.715116 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:34:56.719101 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:34:56.720096 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:56.721093 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:34:56.722095 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:34:56.723532 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:34:56.737308 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.198 seconds
[0m21:34:56.738243 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.198 seconds
[0m21:34:56.742731 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:34:56.746106 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:34:56.747107 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp" rename to "customer_order_frequency"
[0m21:34:56.747107 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:34:56.827752 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.079 seconds
[0m21:34:56.828708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.103 seconds
[0m21:34:56.828708 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m21:34:56.829690 [debug] [Thread-2 (]: SQL status: COMMIT in 0.104 seconds
[0m21:34:56.830687 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:34:56.833270 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:34:56.835255 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:34:56.837250 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:34:56.838247 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:34:56.840242 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:34:56.841749 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:34:56.842400 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:34:56.842400 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:34:56.843746 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:34:56.843746 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:34:56.844748 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:34:56.888870 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m21:34:56.888870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m21:34:56.888870 [debug] [Thread-4 (]: SQL status: COMMIT in 0.044 seconds
[0m21:34:56.891933 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup"
[0m21:34:56.893647 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:34:56.895158 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:34:56.896377 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:34:56.897373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5595ECD0>]}
[0m21:34:56.897373 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:34:56.898371 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup" cascade
[0m21:34:56.898371 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.053 seconds
[0m21:34:56.899368 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 2.17s]
[0m21:34:56.899368 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:34:56.900366 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:34:56.901874 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:34:56.904029 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C556ABED0>]}
[0m21:34:56.904029 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:34:56.904819 [info ] [Thread-2 (]: 6 of 10 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 2.18s]
[0m21:34:56.905820 [info ] [Thread-1 (]: 8 of 10 START sql table model public.orders_by_day ............................. [RUN]
[0m21:34:56.906817 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:34:56.906817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.orders_by_day)
[0m21:34:56.907814 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m21:34:56.907814 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:34:56.908813 [info ] [Thread-2 (]: 9 of 10 START sql table model public.product_performance ....................... [RUN]
[0m21:34:56.911805 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:34:56.911805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m21:34:56.913037 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:34:56.914033 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:34:56.916027 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:34:56.921015 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:34:56.922012 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m21:34:56.922517 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:34:56.925547 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:34:56.926546 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:34:56.927542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:56.927542 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:34:56.928539 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:34:56.928539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:34:57.002848 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.099 seconds
[0m21:34:57.003856 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.104 seconds
[0m21:34:57.010825 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:34:57.016521 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:34:57.019517 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C55A36E90>]}
[0m21:34:57.023141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C556AB450>]}
[0m21:34:57.026208 [info ] [Thread-4 (]: 4 of 10 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 2.30s]
[0m21:34:57.029202 [info ] [Thread-3 (]: 5 of 10 OK created sql table model public.customer_order_frequency ............. [[32mSELECT 642[0m in 2.30s]
[0m21:34:57.031800 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:34:57.033810 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:34:57.034789 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m21:34:57.036786 [info ] [Thread-4 (]: 10 of 10 START sql table model public.category_performance ..................... [RUN]
[0m21:34:57.038804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.category_performance)
[0m21:34:57.039776 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:34:57.044232 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:34:57.046230 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m21:34:57.051803 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:34:57.052800 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:34:57.052800 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:34:57.054121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:34:57.967015 [debug] [Thread-2 (]: SQL status: BEGIN in 1.038 seconds
[0m21:34:57.968008 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:34:57.968008 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:34:58.036306 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.067 seconds
[0m21:34:58.036306 [debug] [Thread-4 (]: SQL status: BEGIN in 0.982 seconds
[0m21:34:58.037304 [debug] [Thread-1 (]: SQL status: BEGIN in 1.110 seconds
[0m21:34:58.042884 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:34:58.042884 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:34:58.044359 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:34:58.046335 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:34:58.047334 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    WITH category_sales AS (
    SELECT
        p.category,
        sum(s.quantity) AS total_sales,
        SUM(s.total_price) AS total_revenue,
        AVG(p.price) AS avg_price
    FROM "d9snqvovhsjpqs"."public"."stg_sales" s
    join "d9snqvovhsjpqs"."public"."stg_products" p
        on s.product_id= p.product_id
    GROUP BY p.category
)

SELECT
    category,
    total_sales,
    total_revenue,
    avg_price
from category_sales
order by total_revenue desc
  );
  
[0m21:34:58.048331 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:34:58.390309 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.340 seconds
[0m21:34:58.402147 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:34:58.403184 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:34:58.439012 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.389 seconds
[0m21:34:58.440008 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.390 seconds
[0m21:34:58.446510 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:34:58.453024 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:34:58.455033 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:34:58.456028 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:34:58.572017 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.166 seconds
[0m21:34:58.572017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.114 seconds
[0m21:34:58.573024 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.115 seconds
[0m21:34:58.574023 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:34:58.577014 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:34:58.581005 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:34:58.582002 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:34:58.582526 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:34:58.582526 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:34:58.583783 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:34:58.857462 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.273 seconds
[0m21:34:58.859472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.275 seconds
[0m21:34:58.860496 [debug] [Thread-2 (]: SQL status: COMMIT in 0.276 seconds
[0m21:34:58.867100 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:34:58.874115 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:34:58.876138 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:34:58.877110 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:34:58.878120 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:34:58.879104 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:34:58.879104 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:34:58.880102 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:34:58.881099 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:34:58.992569 [debug] [Thread-4 (]: SQL status: COMMIT in 0.111 seconds
[0m21:34:58.993575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.111 seconds
[0m21:34:58.993575 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.112 seconds
[0m21:34:58.996137 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:34:58.999129 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:34:59.000128 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m21:34:59.001124 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:34:59.002121 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:34:59.003189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C55667490>]}
[0m21:34:59.003189 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:34:59.004126 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:34:59.004800 [info ] [Thread-2 (]: 9 of 10 OK created sql table model public.product_performance .................. [[32mSELECT 4[0m in 2.09s]
[0m21:34:59.005798 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m21:34:59.059759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.054 seconds
[0m21:34:59.059759 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.055 seconds
[0m21:34:59.061756 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:34:59.062889 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m21:34:59.064050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C55959E10>]}
[0m21:34:59.065047 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a5ca7c-417a-4488-90fb-f08aa9458ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C55A416D0>]}
[0m21:34:59.065047 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 2.16s]
[0m21:34:59.066044 [info ] [Thread-4 (]: 10 of 10 OK created sql table model public.category_performance ................ [[32mSELECT 2[0m in 2.03s]
[0m21:34:59.067042 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:34:59.068039 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m21:34:59.070033 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:59.070033 [debug] [MainThread]: On master: BEGIN
[0m21:34:59.071030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:00.092842 [debug] [MainThread]: SQL status: BEGIN in 1.022 seconds
[0m21:35:00.093966 [debug] [MainThread]: On master: COMMIT
[0m21:35:00.093966 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:00.094967 [debug] [MainThread]: On master: COMMIT
[0m21:35:00.187224 [debug] [MainThread]: SQL status: COMMIT in 0.092 seconds
[0m21:35:00.187224 [debug] [MainThread]: On master: Close
[0m21:35:00.188221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:00.189218 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs' was properly closed.
[0m21:35:00.189218 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m21:35:00.190215 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m21:35:00.190215 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:35:00.190215 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:35:00.190215 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_order_frequency' was properly closed.
[0m21:35:00.191721 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m21:35:00.191721 [info ] [MainThread]: 
[0m21:35:00.192730 [info ] [MainThread]: Finished running 3 view models, 7 table models in 0 hours 0 minutes and 11.42 seconds (11.42s).
[0m21:35:00.194942 [debug] [MainThread]: Command end result
[0m21:35:00.224064 [info ] [MainThread]: 
[0m21:35:00.225061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:00.225061 [info ] [MainThread]: 
[0m21:35:00.226143 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m21:35:00.228054 [debug] [MainThread]: Command `dbt run` succeeded at 21:35:00.227056 after 12.40 seconds
[0m21:35:00.228054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4D4EC110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4D24E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C4D24F350>]}
[0m21:35:00.229051 [debug] [MainThread]: Flushing usage events
[0m21:35:35.533549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA7B7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA7B77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA79BD90>]}


============================== 21:35:35.538043 | 1838db2e-ee4b-4b61-a0e9-99265a3b2ad9 ==============================
[0m21:35:35.538043 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:35:35.538043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:35.599978 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:35:35.600976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1838db2e-ee4b-4b61-a0e9-99265a3b2ad9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9381B10>]}
[0m21:35:35.767005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1838db2e-ee4b-4b61-a0e9-99265a3b2ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA929B10>]}
[0m21:35:35.830086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1838db2e-ee4b-4b61-a0e9-99265a3b2ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC7A1F2D0>]}
[0m21:35:35.831673 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:35:35.840155 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:35:36.005526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:36.006523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:36.010513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:35:36.047141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1838db2e-ee4b-4b61-a0e9-99265a3b2ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA7B6710>]}
[0m21:35:36.191807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1838db2e-ee4b-4b61-a0e9-99265a3b2ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCBDF1A90>]}
[0m21:35:36.192310 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:35:36.192310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1838db2e-ee4b-4b61-a0e9-99265a3b2ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCA9B4990>]}
[0m21:35:36.194628 [info ] [MainThread]: 
[0m21:35:36.195625 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:35:36.197620 [debug] [MainThread]: Command end result
[0m21:35:36.223100 [debug] [MainThread]: Command `dbt test` succeeded at 21:35:36.223100 after 0.76 seconds
[0m21:35:36.224101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3C2C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC398E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC398F350>]}
[0m21:35:36.224101 [debug] [MainThread]: Flushing usage events
[0m21:35:43.270551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DA881CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD7357D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD736810>]}


============================== 21:35:43.274712 | c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc ==============================
[0m21:35:43.274712 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:35:43.275710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\UMASS data\\ecommerce_project\\dbt-project', 'log_path': 'D:\\UMASS data\\ecommerce_project\\dbt-project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m21:35:43.338980 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:35:43.339966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD77AED0>]}
[0m21:35:43.508419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD736490>]}
[0m21:35:43.573995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DA9AEFD0>]}
[0m21:35:43.575989 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:35:43.583970 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:35:43.745945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:43.745945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:43.750932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:35:43.797057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DEA1AA90>]}
[0m21:35:43.911567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DEBBC7D0>]}
[0m21:35:43.912576 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:35:43.912576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DEB68F10>]}
[0m21:35:43.915897 [info ] [MainThread]: 
[0m21:35:43.916895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:43.917892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:35:44.014499 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:35:44.015496 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:35:44.016494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:44.408109 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.392 seconds
[0m21:35:44.411016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:35:44.416035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:35:44.417032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:35:44.422523 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:35:44.424542 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:35:44.425539 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:35:44.425539 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:35:44.426537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:44.426537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:44.745546 [debug] [ThreadPool]: SQL status: BEGIN in 0.318 seconds
[0m21:35:44.746544 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:35:44.747539 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:35:44.749255 [debug] [ThreadPool]: SQL status: BEGIN in 0.322 seconds
[0m21:35:44.749255 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:35:44.750210 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:35:44.784910 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m21:35:44.786837 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:35:44.795087 [debug] [ThreadPool]: SQL status: SELECT 25 in 0.045 seconds
[0m21:35:44.797846 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:35:44.819006 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:35:44.829048 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:35:44.842053 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:44.842053 [debug] [MainThread]: On master: BEGIN
[0m21:35:44.843098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:45.159121 [debug] [MainThread]: SQL status: BEGIN in 0.316 seconds
[0m21:35:45.162128 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:45.164632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:45.216561 [debug] [MainThread]: SQL status: SELECT 4 in 0.049 seconds
[0m21:35:45.224144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DEC00950>]}
[0m21:35:45.227141 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:45.256364 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:45.256364 [debug] [MainThread]: On master: BEGIN
[0m21:35:45.312270 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m21:35:45.315570 [debug] [MainThread]: On master: COMMIT
[0m21:35:45.317565 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:45.320565 [debug] [MainThread]: On master: COMMIT
[0m21:35:45.348810 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m21:35:45.349715 [debug] [MainThread]: On master: Close
[0m21:35:45.350713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:45.350713 [info ] [MainThread]: 
[0m21:35:45.355710 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m21:35:45.355710 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m21:35:45.356709 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.ecommerce_project.sales_snapshot'
[0m21:35:45.357707 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m21:35:45.364638 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m21:35:45.411784 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:45.412288 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m21:35:45.412288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:45.755694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.343 seconds
[0m21:35:45.756698 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:45.756698 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:35:45.801336 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.043 seconds
[0m21:35:45.825174 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:45.826172 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

        
  
    

  create temporary table "sales_snapshot__dbt_tmp213545819583"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:35:45.872047 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.045 seconds
[0m21:35:45.875040 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:45.876037 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp213545819583'
        
      order by ordinal_position

  
[0m21:35:45.911081 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.034 seconds
[0m21:35:45.914829 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:45.914829 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:35:45.947049 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.031 seconds
[0m21:35:45.953531 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:45.953531 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp213545819583'
        
      order by ordinal_position

  
[0m21:35:45.982226 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.027 seconds
[0m21:35:46.021391 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.022421 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:35:46.051809 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.029 seconds
[0m21:35:46.057309 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.058307 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp213545819583'
        
      order by ordinal_position

  
[0m21:35:46.085865 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.027 seconds
[0m21:35:46.099364 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.100361 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m21:35:46.124593 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m21:35:46.129465 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.130462 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:35:46.154600 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m21:35:46.155602 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.156598 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.157595 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      update "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sales_snapshot__dbt_tmp213545819583" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_valid_to is null;

    insert into "d9snqvovhsjpqs"."snapshots"."sales_snapshot" ("order_id", "customer_id", "product_id", "order_date", "quantity", "total_price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."total_price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sales_snapshot__dbt_tmp213545819583" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:35:46.186886 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.028 seconds
[0m21:35:46.218454 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m21:35:46.219453 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:35:46.220451 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m21:35:46.252924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m21:35:46.256422 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m21:35:46.258393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ff6bb2-276c-4b5c-8dd4-2dbbbfb2b3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DD878D90>]}
[0m21:35:46.259421 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mINSERT 0 0[0m in 0.90s]
[0m21:35:46.260388 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m21:35:46.261893 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:46.262920 [debug] [MainThread]: On master: BEGIN
[0m21:35:46.262920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:46.617386 [debug] [MainThread]: SQL status: BEGIN in 0.354 seconds
[0m21:35:46.618103 [debug] [MainThread]: On master: COMMIT
[0m21:35:46.619104 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:46.620124 [debug] [MainThread]: On master: COMMIT
[0m21:35:46.652895 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m21:35:46.655809 [debug] [MainThread]: On master: Close
[0m21:35:46.656813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:46.657810 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs' was properly closed.
[0m21:35:46.658806 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m21:35:46.659805 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m21:35:46.660800 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m21:35:46.660800 [info ] [MainThread]: 
[0m21:35:46.661807 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m21:35:46.663079 [debug] [MainThread]: Command end result
[0m21:35:46.691068 [info ] [MainThread]: 
[0m21:35:46.692072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:46.692072 [info ] [MainThread]: 
[0m21:35:46.693428 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:35:46.694425 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:35:46.694425 after 3.50 seconds
[0m21:35:46.695422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8D6A0EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8D6A0E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8D6A0EF10>]}
[0m21:35:46.696419 [debug] [MainThread]: Flushing usage events
